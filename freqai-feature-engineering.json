{"version":2,"kind":"Article","sha256":"8acf421d68bed9dae5c4285dcd25fd2fd2aa801ed6946b8cdbebb90b6e9b5b56","slug":"freqai-feature-engineering","location":"/freqai-feature-engineering.md","dependencies":[],"frontmatter":{"title":"FreqAI 特征工程指南","description":"本文档详细介绍了 FreqAI 的特征工程功能,包括如何定义和扩展特征、数据处理管道、异常值检测等内容。这些功能可以帮助用户构建更强大的预测模型。","short_title":"特征工程","subtitle":"特征工程和数据处理的详细说明","subject":"FreqAI 特征工程文档","authors":[{"id":"Freqtrade","name":"Freqtrade"}],"github":"https://github.com/freqtrade-cn/docs_zh-CN","keywords":["Freqtrade","中文文档","交易机器人","量化交易","加密货币","数字货币","区块链","人工智能","机器学习"],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/freqtrade-cn/docs_zh-CN/blob/main/freqai-feature-engineering.md","thumbnail":"/build/freqai_weight-factor-70f8aa4395fdd17979cf8f96e17171d0.jpg","thumbnailOptimized":"/build/freqai_weight-factor-70f8aa4395fdd17979cf8f96e17171d0.webp","exports":[{"format":"md","filename":"freqai-feature-engineering.md","url":"/build/freqai-feature-engin-1abbd861cb4cc851b069f037281b4345.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"特征工程","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"muESKi5oSo"}],"identifier":"id","label":"特征工程","html_id":"id","implicit":true,"key":"Z77r1Eyz2R"},{"type":"heading","depth":3,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"定义特征","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vwyZE8e3GA"}],"identifier":"id","label":"定义特征","html_id":"id-1","implicit":true,"key":"oaYfKOD66E"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"低层次特征工程在用户策略中通过一组名为 ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"lsfc4ns4Cn"},{"type":"inlineCode","value":"feature_engineering_*","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wafZIj5QYJ"},{"type":"text","value":" 的函数完成。这些函数设置\"基础特征\"，如 ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"RlWQqxo2rH"},{"type":"inlineCode","value":"RSI","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"exTUcUnySb"},{"type":"text","value":"、","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KA2C7HLyUD"},{"type":"inlineCode","value":"MFI","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"P85Fv3bqbj"},{"type":"text","value":"、","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"T5NmrQ4kZG"},{"type":"inlineCode","value":"EMA","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"JIX5Zlu9tP"},{"type":"text","value":"、","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"zCeNoShvIj"},{"type":"inlineCode","value":"SMA","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"PdhISzxwqO"},{"type":"text","value":"、一天中的时间、交易量等。\"基础特征\"可以是自定义指标，也可以从任何技术分析库中导入。FreqAI 配备了一组函数，以简化大规模特征工程的快速实现：","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"WCE6jqJjbu"}],"key":"jnyjvju6EY"},{"type":"table","position":{"start":{"line":15,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"函数","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"kmpyX2wDIe"}],"key":"OD3cIbw36F"},{"type":"tableCell","header":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"描述","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ZisxhYZUBL"}],"key":"ZB3pPfIChb"}],"key":"z8GUZjYUnc"},{"type":"tableRow","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineCode","value":"feature_engineering_expand_all()","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"tcVaeCtmHo"}],"key":"WOXvYSOVEd"},{"type":"tableCell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"此可选函数将根据配置中定义的 ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"KQ17uG9M4I"},{"type":"inlineCode","value":"indicator_periods_candles","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"lpgl6rdTaa"},{"type":"text","value":"、","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"XDHew5mOkK"},{"type":"inlineCode","value":"include_timeframes","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"v58ULsJ501"},{"type":"text","value":"、","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"PJP3cL3IGF"},{"type":"inlineCode","value":"include_shifted_candles","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"CvENRrekXe"},{"type":"text","value":" 和 ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"tHS6fGXXke"},{"type":"inlineCode","value":"include_corr_pairs","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"WJQUCxHz58"},{"type":"text","value":" 自动扩展定义的特征。","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"cmdNkvney4"}],"key":"KcAUyZnEQV"}],"key":"KbTrFHaBfG"},{"type":"tableRow","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"inlineCode","value":"feature_engineering_expand_basic()","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"pQFkF8OlKK"}],"key":"xAjtf2Mckg"},{"type":"tableCell","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"此可选函数将根据配置中定义的 ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"JH0F3RG0yW"},{"type":"inlineCode","value":"include_timeframes","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"IwizHbqtWi"},{"type":"text","value":"、","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"vgfnLfL96y"},{"type":"inlineCode","value":"include_shifted_candles","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"AjwfhpMwRf"},{"type":"text","value":" 和 ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ovoBnhcKgc"},{"type":"inlineCode","value":"include_corr_pairs","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Mw4IDPiLVV"},{"type":"text","value":" 自动扩展定义的特征。注意：此函数","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"DYToKaccaO"},{"type":"emphasis","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"不会","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"RqyKszs0al"}],"key":"edPT9hjkC3"},{"type":"text","value":"在 ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"cxILuIob1Q"},{"type":"inlineCode","value":"indicator_periods_candles","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"XOQYgHPYbt"},{"type":"text","value":" 上扩展。","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"WnF66KOzhj"}],"key":"Q8Zdyd3kr7"}],"key":"FKMEP3HvWi"},{"type":"tableRow","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"inlineCode","value":"feature_engineering_standard()","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"sHLJodDlVr"}],"key":"I236MLbfR2"},{"type":"tableCell","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"此可选函数将使用基础时间框架的数据框调用一次。这是最后调用的函数，意味着进入此函数的数据框将包含由其他 ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"LwM6Zv2vKz"},{"type":"inlineCode","value":"feature_engineering_expand","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"NUJAEqP6Nb"},{"type":"text","value":" 函数创建的所有特征和列。此函数是进行自定义特征提取（例如 tsfresh）的好地方。此函数也是任何不应自动扩展的特征（例如星期几）的好地方。","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"jtjdCZxdzB"}],"key":"vLWYIvixus"}],"key":"Bk5RrCSbGs"},{"type":"tableRow","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"inlineCode","value":"set_freqai_targets()","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"vmKVUeatLm"}],"key":"ZD2S9pnoJ2"},{"type":"tableCell","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"设置模型目标的必需函数。所有目标必须以 ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"c6e29zIO8z"},{"type":"inlineCode","value":"&","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"H89CtNDJ60"},{"type":"text","value":" 开头，以便 FreqAI 内部识别。","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"C8kvnxvwqJ"}],"key":"JbNh39oArB"}],"key":"kVVnQqO0ey"}],"key":"kcjxI0QEnR"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"同时，高层次特征工程在 FreqAI 配置的 ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"cwW63Yzivs"},{"type":"inlineCode","value":"\"feature_parameters\":{}","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"D0QrsWB5Ca"},{"type":"text","value":" 中处理。在此文件中，可以决定在\"基础特征\"之上进行大规模特征扩展，例如\"包含相关对\"或\"包含信息时间框架\"，甚至\"包含最近的蜡烛\"。","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"wx4E9iOKjH"}],"key":"qXrJmZUqN8"},{"type":"paragraph","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"建议从提供的示例策略（位于 ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"LzEnjHoMlo"},{"type":"inlineCode","value":"templates/FreqaiExampleStrategy.py","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"nJOGRoOg7v"},{"type":"text","value":"）中的模板 ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"TvALPJooXp"},{"type":"inlineCode","value":"feature_engineering_*","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"SrdLkuK4Nc"},{"type":"text","value":" 函数开始，以确保特征定义遵循正确的约定。以下是如何在策略中设置指标和标签的示例：","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"aeDgtZjtqF"}],"key":"YOcvgcROSh"},{"type":"code","lang":"python","value":"    def feature_engineering_expand_all(self, dataframe: DataFrame, period, metadata, **kwargs) -> DataFrame:\n        \"\"\"\n        *仅适用于启用 FreqAI 的策略*\n        此函数将根据配置中定义的 `indicator_periods_candles`、`include_timeframes`、`include_shifted_candles` 和 `include_corr_pairs` 自动扩展定义的特征。换句话说，在此函数中定义的单个特征将自动扩展为 `indicator_periods_candles` * `include_timeframes` * `include_shifted_candles` * `include_corr_pairs` 个特征添加到模型中。\n\n        所有特征必须以 `%` 开头，以便 FreqAI 内部识别。\n\n        访问元数据，如当前对/时间框架/周期：\n\n        `metadata[\"pair\"]` `metadata[\"tf\"]`  `metadata[\"period\"]`\n\n        :param df: 将接收特征的策略数据框\n        :param period: 指标的周期 - 使用示例：\n        :param metadata: 当前对的元数据\n        dataframe[\"%-ema-period\"] = ta.EMA(dataframe, timeperiod=period)\n        \"\"\"\n\n        dataframe[\"%-rsi-period\"] = ta.RSI(dataframe, timeperiod=period)\n        dataframe[\"%-mfi-period\"] = ta.MFI(dataframe, timeperiod=period)\n        dataframe[\"%-adx-period\"] = ta.ADX(dataframe, timeperiod=period)\n        dataframe[\"%-sma-period\"] = ta.SMA(dataframe, timeperiod=period)\n        dataframe[\"%-ema-period\"] = ta.EMA(dataframe, timeperiod=period)\n\n        bollinger = qtpylib.bollinger_bands(\n            qtpylib.typical_price(dataframe), window=period, stds=2.2\n        )\n        dataframe[\"bb_lowerband-period\"] = bollinger[\"lower\"]\n        dataframe[\"bb_middleband-period\"] = bollinger[\"mid\"]\n        dataframe[\"bb_upperband-period\"] = bollinger[\"upper\"]\n\n        dataframe[\"%-bb_width-period\"] = (\n            dataframe[\"bb_upperband-period\"]\n            - dataframe[\"bb_lowerband-period\"]\n        ) / dataframe[\"bb_middleband-period\"]\n        dataframe[\"%-close-bb_lower-period\"] = (\n            dataframe[\"close\"] / dataframe[\"bb_lowerband-period\"]\n        )\n\n        dataframe[\"%-roc-period\"] = ta.ROC(dataframe, timeperiod=period)\n\n        dataframe[\"%-relative_volume-period\"] = (\n            dataframe[\"volume\"] / dataframe[\"volume\"].rolling(period).mean()\n        )\n\n        return dataframe\n\n    def feature_engineering_expand_basic(self, dataframe: DataFrame, metadata, **kwargs) -> DataFrame:\n        \"\"\"\n        *仅适用于启用 FreqAI 的策略*\n        此函数将根据配置中定义的 `include_timeframes`、`include_shifted_candles` 和 `include_corr_pairs` 自动扩展定义的特征。换句话说，在此函数中定义的单个特征将自动扩展为 `include_timeframes` * `include_shifted_candles` * `include_corr_pairs` 个特征添加到模型中。\n\n        在此定义的特征*不会*在用户定义的 `indicator_periods_candles` 上自动复制。\n\n        访问元数据，如当前对/时间框架：\n\n        `metadata[\"pair\"]` `metadata[\"tf\"]`\n\n        所有特征必须以 `%` 开头，以便 FreqAI 内部识别。\n\n        :param df: 将接收特征的策略数据框\n        :param metadata: 当前对的元数据\n        dataframe[\"%-pct-change\"] = dataframe[\"close\"].pct_change()\n        dataframe[\"%-ema-200\"] = ta.EMA(dataframe, timeperiod=200)\n        \"\"\"\n        dataframe[\"%-pct-change\"] = dataframe[\"close\"].pct_change()\n        dataframe[\"%-raw_volume\"] = dataframe[\"volume\"]\n        dataframe[\"%-raw_price\"] = dataframe[\"close\"]\n        return dataframe\n\n    def feature_engineering_standard(self, dataframe: DataFrame, metadata, **kwargs) -> DataFrame:\n        \"\"\"\n        *仅适用于启用 FreqAI 的策略*\n        此可选函数将使用基础时间框架的数据框调用一次。这是最后调用的函数，意味着进入此函数的数据框将包含由所有其他 freqai_feature_engineering_* 函数创建的所有特征和列。\n\n        此函数是进行自定义特征提取（例如 tsfresh）的好地方。此函数也是任何不应自动扩展的特征（例如星期几）的好地方。\n\n        访问元数据，如当前对：\n\n        `metadata[\"pair\"]`\n\n        所有特征必须以 `%` 开头，以便 FreqAI 内部识别。\n\n        :param df: 将接收特征的策略数据框\n        :param metadata: 当前对的元数据\n        使用示例：dataframe[\"%-day_of_week\"] = (dataframe[\"date\"].dt.dayofweek + 1) / 7\n        \"\"\"\n        dataframe[\"%-day_of_week\"] = (dataframe[\"date\"].dt.dayofweek + 1) / 7\n        dataframe[\"%-hour_of_day\"] = (dataframe[\"date\"].dt.hour + 1) / 25\n        return dataframe\n\n    def set_freqai_targets(self, dataframe: DataFrame, metadata, **kwargs) -> DataFrame:\n        \"\"\"\n        *仅适用于启用 FreqAI 的策略*\n        设置模型目标的必需函数。所有目标必须以 `&` 开头，以便 FreqAI 内部识别。\n\n        访问元数据，如当前对：\n\n        `metadata[\"pair\"]`\n\n        :param df: 将接收目标的策略数据框\n        :param metadata: 当前对的元数据\n        使用示例：dataframe[\"&-target\"] = dataframe[\"close\"].shift(-1) / dataframe[\"close\"]\n        \"\"\"\n        dataframe[\"&-s_close\"] = (\n            dataframe[\"close\"]\n            .shift(-self.freqai_info[\"feature_parameters\"][\"label_period_candles\"])\n            .rolling(self.freqai_info[\"feature_parameters\"][\"label_period_candles\"])\n            .mean()\n            / dataframe[\"close\"]\n            - 1\n            )\n        \n        return dataframe","position":{"start":{"line":26,"column":1},"end":{"line":140,"column":1}},"key":"L1pG2sWF8h"},{"type":"paragraph","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"text","value":"在提供的示例中，用户不希望将 ","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"HxmihQsS4k"},{"type":"inlineCode","value":"bb_lowerband","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"F5jt7ADdj9"},{"type":"text","value":" 作为特征传递给模型，因此没有以 ","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"SUgz2V3ZCp"},{"type":"inlineCode","value":"%","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"Gg98pNN6cZ"},{"type":"text","value":" 开头。然而，用户希望将 ","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"tQSb23FjXq"},{"type":"inlineCode","value":"bb_width","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"k0mg0vi6Mb"},{"type":"text","value":" 传递给模型进行训练/预测，因此以 ","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"iQ5YNJopjN"},{"type":"inlineCode","value":"%","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"v1SsCZ1UPi"},{"type":"text","value":" 开头。","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"uLzx1308MN"}],"key":"p83TLFqzSj"},{"type":"paragraph","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"text","value":"在定义了\"基础特征\"后，下一步是使用配置文件中的强大 ","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"rZrO81GNtI"},{"type":"inlineCode","value":"feature_parameters","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"SqwRu0pbv3"},{"type":"text","value":" 进行扩展：","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"c4Aoj56JWO"}],"key":"IRceWqpKmf"},{"type":"code","lang":"json","value":"    \"freqai\": {\n        //...\n        \"feature_parameters\" : {\n            \"include_timeframes\": [\"5m\",\"15m\",\"4h\"],\n            \"include_corr_pairlist\": [\n                \"ETH/USD\",\n                \"LINK/USD\",\n                \"BNB/USD\"\n            ],\n            \"label_period_candles\": 24,\n            \"include_shifted_candles\": 2,\n            \"indicator_periods_candles\": [10, 20]\n        },\n        //...\n    }","position":{"start":{"line":146,"column":1},"end":{"line":162,"column":1}},"key":"wWOA5SdYj1"},{"type":"paragraph","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"children":[{"type":"text","value":"上述配置中的 ","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"GzuDmoLaBH"},{"type":"inlineCode","value":"include_timeframes","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"A7HmPfo6LT"},{"type":"text","value":" 是策略中每次调用 ","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"uuPT1YhYVI"},{"type":"inlineCode","value":"feature_engineering_expand_*()","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"zDnO5tLo2W"},{"type":"text","value":" 的时间框架（","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"cFDTCGCZs5"},{"type":"inlineCode","value":"tf","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"W6av19mBED"},{"type":"text","value":"）。在提供的案例中，用户要求将 ","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"m7Ynp0bdGL"},{"type":"inlineCode","value":"5m","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"oj3yuZ298t"},{"type":"text","value":"、","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"VJbqktAJL7"},{"type":"inlineCode","value":"15m","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"m2iUzbzqCY"},{"type":"text","value":" 和 ","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"q2z1VIn8CA"},{"type":"inlineCode","value":"4h","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"daMiDnCYSy"},{"type":"text","value":" 时间框架的 ","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"VuaRFUS46n"},{"type":"inlineCode","value":"rsi","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"QTSiEO2tUt"},{"type":"text","value":"、","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"U3MJpwj6RL"},{"type":"inlineCode","value":"mfi","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"NcgQiuurGT"},{"type":"text","value":"、","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"TKz0ZGejly"},{"type":"inlineCode","value":"roc","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"zSKKCaeyXp"},{"type":"text","value":" 和 ","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"gFZiFgProl"},{"type":"inlineCode","value":"bb_width","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"g06mRVzcuD"},{"type":"text","value":" 包含在特征集中。","position":{"start":{"line":164,"column":1},"end":{"line":164,"column":1}},"key":"kvUCHBhSXb"}],"key":"D4k2nCAKch"},{"type":"paragraph","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"children":[{"type":"text","value":"您可以使用 ","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"usp8buGisV"},{"type":"inlineCode","value":"include_corr_pairlist","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"fAwsXU60Bz"},{"type":"text","value":" 要求将每个定义的特征也包含在信息对中。这意味着特征集将包含 ","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"QW4sLi89Hc"},{"type":"inlineCode","value":"feature_engineering_expand_*()","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"cK5sbwbHQv"},{"type":"text","value":" 在配置中定义的每个相关对（在提供的示例中为 ","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"Gz4LR4ec6z"},{"type":"inlineCode","value":"ETH/USD","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"lQzBoxUFFf"},{"type":"text","value":"、","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"N39c38X60U"},{"type":"inlineCode","value":"LINK/USD","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"SP2kfLAUcx"},{"type":"text","value":" 和 ","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"CjIZAjvbAx"},{"type":"inlineCode","value":"BNB/USD","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"JZeEHa4DVI"},{"type":"text","value":"）的所有 ","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"ilvfAjR9kH"},{"type":"inlineCode","value":"include_timeframes","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"VGli05yKlT"},{"type":"text","value":" 上的所有特征。","position":{"start":{"line":166,"column":1},"end":{"line":166,"column":1}},"key":"NYRb5be775"}],"key":"BUaT4HlwBY"},{"type":"paragraph","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"children":[{"type":"inlineCode","value":"include_shifted_candles","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"Z9AxrbZhNS"},{"type":"text","value":" 表示要包含在特征集中的前几根蜡烛的数量。例如，","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"zT6Prwn6Dc"},{"type":"inlineCode","value":"include_shifted_candles: 2","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"I3z4ObGFJ7"},{"type":"text","value":" 告诉 FreqAI 在特征集中包含每个特征的前 2 根蜡烛。","position":{"start":{"line":168,"column":1},"end":{"line":168,"column":1}},"key":"ekHnUhAXZz"}],"key":"YZRmoxwig3"},{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"总的来说，提供的示例策略用户创建的特征数量为：","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"YiED02kK05"},{"type":"inlineCode","value":"include_timeframes","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"SdOSej4vrk"},{"type":"text","value":" 的长度 * ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"xzPPOIyyzU"},{"type":"inlineCode","value":"feature_engineering_expand_*()","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"AR50aqrltD"},{"type":"text","value":" 中的特征数量 * ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"VcyTUhz2oJ"},{"type":"inlineCode","value":"include_corr_pairlist","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"MHzBtbbYaY"},{"type":"text","value":" 的长度 * ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"ZYZaOcRmZq"},{"type":"inlineCode","value":"include_shifted_candles","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"EjV7Lf9tu9"},{"type":"text","value":" 的数量 * ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"RF1wtwpUQl"},{"type":"inlineCode","value":"indicator_periods_candles","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"vGEmhT2fCZ"},{"type":"text","value":" 的长度 ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"xK6IcD2SE3"},{"type":"inlineMath","value":"= 3 * 3 * 3 * 2 * 2 = 108","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>=</mo><mn>3</mn><mo>∗</mo><mn>3</mn><mo>∗</mo><mn>3</mn><mo>∗</mo><mn>2</mn><mo>∗</mo><mn>2</mn><mo>=</mo><mn>108</mn></mrow><annotation encoding=\"application/x-tex\">= 3 * 3 * 3 * 2 * 2 = 108</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">108</span></span></span></span>","key":"m5wIQa0Y3f"},{"type":"text","value":"。","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"CRpSklyAZ5"}],"key":"HnQqaEfIOO"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"了解更多关于创造性特征工程的信息","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"GdTWl0cnhf"}],"key":"gKvwCnBE4K"},{"type":"paragraph","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"查看我们的","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"GP92sz2f4r"},{"type":"link","url":"https://emergentmethods.medium.com/freqai-from-price-to-prediction-6fadac18b665","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"medium文章","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"umC9Xwln3n"}],"urlSource":"https://emergentmethods.medium.com/freqai-from-price-to-prediction-6fadac18b665","key":"sLJX5mTen9"},{"type":"text","value":"，旨在帮助用户学习如何创造性地进行特征工程。","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"mF9xKGF15L"}],"key":"ipMzD6IreV"}],"key":"IcmFhpmA5B"},{"type":"heading","depth":4,"position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"使用 ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"kYosZNgWTP"},{"type":"inlineCode","value":"metadata","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"OvTp2lkGUK"},{"type":"text","value":" 对 ","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"CwJtXT6by7"},{"type":"inlineCode","value":"feature_engineering_*","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"OPgUuPsDSt"},{"type":"text","value":" 函数进行更精细的控制","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"A8GXcWSfM0"}],"identifier":"id-metadata-feature-engineering","label":"使用 metadata 对 feature_engineering_* 函数进行更精细的控制","html_id":"id-metadata-feature-engineering","implicit":true,"key":"TXKucQt6Y9"},{"type":"paragraph","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"children":[{"type":"text","value":"所有 ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"PvAK5BmHH3"},{"type":"inlineCode","value":"feature_engineering_*","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"bGSHPdWI3E"},{"type":"text","value":" 和 ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"RvvUTL1hpr"},{"type":"inlineCode","value":"set_freqai_targets()","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"D6HpHee1LH"},{"type":"text","value":" 函数都传递一个 ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"NyXMeIwaiC"},{"type":"inlineCode","value":"metadata","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"nv9sS16R8v"},{"type":"text","value":" 字典，其中包含 FreqAI 用于特征构建的 ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"p0oMI4hyI7"},{"type":"inlineCode","value":"pair","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"rEzSmt8IPk"},{"type":"text","value":"、","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"kVOIR9dZ4C"},{"type":"inlineCode","value":"tf","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"k768c1Ejso"},{"type":"text","value":"（时间框架）和 ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"A8OonR5HqZ"},{"type":"inlineCode","value":"period","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"g3nmVG93gz"},{"type":"text","value":" 信息。因此，用户可以在 ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"M24UBczNJa"},{"type":"inlineCode","value":"feature_engineering_*","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"oKFhZ3S4En"},{"type":"text","value":" 函数中使用 ","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"nZRyvYS0qm"},{"type":"inlineCode","value":"metadata","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"yRqRdx2A7O"},{"type":"text","value":" 作为阻止/保留特定时间框架、周期、对等的特征的标准。","position":{"start":{"line":178,"column":1},"end":{"line":178,"column":1}},"key":"lZmHQPBUZP"}],"key":"ujCwAXZh9B"},{"type":"code","lang":"python","value":"def feature_engineering_expand_all(self, dataframe: DataFrame, period, metadata, **kwargs) -> DataFrame:\n    if metadata[\"tf\"] == \"1h\":\n        dataframe[\"%-roc-period\"] = ta.ROC(dataframe, timeperiod=period)","position":{"start":{"line":180,"column":1},"end":{"line":184,"column":1}},"key":"W9aL4bEbga"},{"type":"paragraph","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"children":[{"type":"text","value":"这将阻止 ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"sgiWF6Di6Q"},{"type":"inlineCode","value":"ta.ROC()","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"vTSQArIsQT"},{"type":"text","value":" 添加到除 ","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"PlQcCfZo26"},{"type":"inlineCode","value":"\"1h\"","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"Tx56S5B8ok"},{"type":"text","value":" 以外的任何时间框架。","position":{"start":{"line":186,"column":1},"end":{"line":186,"column":1}},"key":"D2vjh8Y0mo"}],"key":"DGAFNkUlp2"},{"type":"heading","depth":4,"position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"从训练中返回额外信息","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"Lqa7dcIBlK"}],"identifier":"id","label":"从训练中返回额外信息","html_id":"id-2","implicit":true,"key":"asSTEjvsPm"},{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"重要指标可以通过在自定义预测模型类中将其分配给 ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"u0VWZUDhi7"},{"type":"inlineCode","value":"dk.data['extra_returns_per_train']['my_new_value'] = XYZ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"gxdECDPnQV"},{"type":"text","value":" 返回到策略。","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"xKDGKftaR1"}],"key":"iNNd04Lw26"},{"type":"paragraph","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"FreqAI 获取在此字典中分配的 ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"KfoaH3oLhB"},{"type":"inlineCode","value":"my_new_value","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"dy8EywAEOp"},{"type":"text","value":" 并将其扩展以适应返回到策略的数据框。然后，您可以通过 ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"lCHZ6EF7tw"},{"type":"inlineCode","value":"dataframe['my_new_value']","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"dQ7AVQmGIs"},{"type":"text","value":" 在策略中使用返回的指标。FreqAI 中如何使用返回值的示例是用于","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"dthQwwk2eB"},{"type":"crossReference","url":"/freqai-configuration","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"text","value":"创建动态目标阈值","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"qS4nJhp81Z"}],"urlSource":"freqai-configuration.md#creating-a-dynamic-target-threshold","dataUrl":"/freqai-configuration.json","identifier":"creating-a-dynamic-target-threshold","label":"creating-a-dynamic-target-threshold","remote":true,"protocol":"file","key":"kyPJl1d5b0"},{"type":"text","value":"的 ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"p4swqHj4fR"},{"type":"inlineCode","value":"&*_mean","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"tp99yPyk4a"},{"type":"text","value":" 和 ","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"tUN7ipprPm"},{"type":"inlineCode","value":"&*_std","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"fa3qzMq5Ce"},{"type":"text","value":" 值。","position":{"start":{"line":192,"column":1},"end":{"line":192,"column":1}},"key":"YDSWRv4pmD"}],"key":"nsfuoi5DmD"},{"type":"paragraph","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"另一个示例，用户希望使用来自交易数据库的实时指标，如下所示：","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"OSMWWWv5v4"}],"key":"ITDDjWfD3A"},{"type":"code","lang":"json","value":"    \"freqai\": {\n        \"extra_returns_per_train\": {\"total_profit\": 4}\n    }","position":{"start":{"line":196,"column":1},"end":{"line":200,"column":1}},"key":"qFvXLKjwFl"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"您需要在配置中设置标准字典，以便 FreqAI 可以返回适当的数据框形状。这些值可能会被预测模型覆盖，但在模型尚未设置它们或需要默认初始值的情况下，预设值将是返回的值。","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"pKQ5jsZ3IE"}],"key":"aTym48QCPT"},{"type":"heading","depth":4,"position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"为时间重要性加权特征","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"V219SnsdBC"}],"identifier":"id","label":"为时间重要性加权特征","html_id":"id-3","implicit":true,"key":"kW4m1SRro9"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"FreqAI 允许您通过指数函数设置 ","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"dCgaEQIpCA"},{"type":"inlineCode","value":"weight_factor","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"Sp4dCpy1S2"},{"type":"text","value":" 以更强烈地加权最近的数据：","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"JXARb7KG7T"}],"key":"qX8UokjSNh"},{"type":"math","value":"W_i = \\exp(\\frac{-i}{\\alpha*n})","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mfrac><mrow><mo>−</mo><mi>i</mi></mrow><mrow><mi>α</mi><mo>∗</mo><mi>n</mi></mrow></mfrac><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W_i = \\exp(\\frac{-i}{\\alpha*n})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0225em;vertical-align:-0.686em;\"></span><span class=\"mop\">exp</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3365em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord mathnormal\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"1","key":"SWwCRiMdBV"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"其中 ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"a2q4KoduHA"},{"type":"inlineMath","value":"W_i","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">W_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"V4g8vzBpEJ"},{"type":"text","value":" 是总数据集中第 ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"EfxpPg6Orw"},{"type":"inlineMath","value":"i","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>","key":"ivgCAXacKM"},{"type":"text","value":" 个数据点的权重，","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"EINBzf1Cvx"},{"type":"inlineMath","value":"n","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span>","key":"U8TIaVKiRx"},{"type":"text","value":" 是数据点的总数。下图显示了不同权重因子对特征集中数据点的影响。","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"nIcuxfAZPr"}],"key":"L7b56u3zc1"},{"type":"image","url":"/build/freqai_weight-factor-70f8aa4395fdd17979cf8f96e17171d0.jpg","alt":"weight-factor","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"XLYudVzlNg","urlSource":"assets/freqai_weight-factor.jpg","urlOptimized":"/build/freqai_weight-factor-70f8aa4395fdd17979cf8f96e17171d0.webp"},{"type":"heading","depth":3,"position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"构建数据管道","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"QEUCH6MSEd"}],"identifier":"id","label":"构建数据管道","html_id":"id-4","implicit":true,"key":"RKVNZts4Yh"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"默认情况下，FreqAI 根据用户配置设置构建动态管道。默认设置是健壮的，设计用于与各种方法一起工作。这两个步骤是 ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"a4m5MQVkFS"},{"type":"inlineCode","value":"MinMaxScaler(-1,1)","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"zZCJvpI87v"},{"type":"text","value":" 和 ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"GIbNbONDls"},{"type":"inlineCode","value":"VarianceThreshold","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"XETR1nxjIU"},{"type":"text","value":"，后者移除任何方差为 0 的列。用户可以通过更多配置参数激活其他步骤。例如，如果用户在 ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"u7RfGb7YbJ"},{"type":"inlineCode","value":"freqai","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"OxsD2ncw2D"},{"type":"text","value":" 配置中添加 ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"a9zgbUiGq3"},{"type":"inlineCode","value":"use_SVM_to_remove_outliers: true","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"E2psYMHeg3"},{"type":"text","value":"，则 FreqAI 将自动将 ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"nPepJc2PCL"},{"type":"link","url":"#identifying-outliers-using-a-support-vector-machine-svm","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"inlineCode","value":"SVMOutlierExtractor","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"ydeqQrmR5d"}],"urlSource":"#identifying-outliers-using-a-support-vector-machine-svm","key":"IFhcjzJYRn"},{"type":"text","value":" 添加到管道中。同样，用户可以添加 ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"qjO3zvFONp"},{"type":"inlineCode","value":"principal_component_analysis: true","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"DEhgdtPdP5"},{"type":"text","value":" 到 ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"mSdcfPWpyV"},{"type":"inlineCode","value":"freqai","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"E6cbC89h7G"},{"type":"text","value":" 配置中以激活 PCA。","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"jlz8LJyPa9"},{"type":"link","url":"#identifying-outliers-with-the-dissimilarity-index-di","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"DissimilarityIndex","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"ME4HIh6Y2S"}],"urlSource":"#identifying-outliers-with-the-dissimilarity-index-di","key":"rhsAYRDZr0"},{"type":"text","value":" 通过 ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"SEiyLGM3By"},{"type":"inlineCode","value":"DI_threshold: 1","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"oooX3fKS39"},{"type":"text","value":" 激活。最后，也可以通过 ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"zHAiPnk3Mj"},{"type":"inlineCode","value":"noise_standard_deviation: 0.1","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"BMAIBzFD0d"},{"type":"text","value":" 向数据添加噪声。最后，用户可以通过 ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"Hvn5aHUxP2"},{"type":"inlineCode","value":"use_DBSCAN_to_remove_outliers: true","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"DXPK582lKQ"},{"type":"text","value":" 添加 ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"s5nmk9Bf7w"},{"type":"link","url":"#identifying-outliers-with-dbscan","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"DBSCAN","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"ldcaZZmY91"}],"urlSource":"#identifying-outliers-with-dbscan","key":"Cc19DBEaix"},{"type":"text","value":" 异常值移除。","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"eiKz1W8JHK"}],"key":"BIdCMDWwZL"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"更多信息可用","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"hBL1GMCwZs"}],"key":"e5Bh6NF3p4"},{"type":"paragraph","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"请查看","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"gMVHPW6vqn"},{"type":"link","url":"/freqai-parameter-table","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"参数表","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"aEKifofKBx"}],"urlSource":"freqai-parameter-table.md","dataUrl":"/freqai-parameter-table.json","internal":true,"protocol":"file","key":"BCauSsaw9j"},{"type":"text","value":"以获取有关这些参数的更多信息。","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"pikk7xB1Oy"}],"key":"dyj1PEOaKx"}],"key":"J6L8YN3dkO"},{"type":"heading","depth":4,"position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"children":[{"type":"text","value":"自定义管道","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"key":"IIcRaF5cxO"}],"identifier":"id","label":"自定义管道","html_id":"id-5","implicit":true,"key":"zmXituDJGm"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"鼓励用户通过构建自己的数据管道来满足其需求。这可以通过在 ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"ePEzRWzgj5"},{"type":"inlineCode","value":"IFreqaiModel","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"WZML8k1pSS"},{"type":"text","value":" 的 ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"r0wWBbeben"},{"type":"inlineCode","value":"train()","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"xx1HE0Lw2r"},{"type":"text","value":" 函数中简单地将 ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"nYV2KZV9sd"},{"type":"inlineCode","value":"dk.feature_pipeline","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"J9W1zpAvjo"},{"type":"text","value":" 设置为其所需的 ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"cu8QaWkLaa"},{"type":"inlineCode","value":"Pipeline","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"OsQ5QfTqQS"},{"type":"text","value":" 对象来完成，或者如果他们不想修改 ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"r5K5bH7qMR"},{"type":"inlineCode","value":"train()","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"vBn8eDqadY"},{"type":"text","value":" 函数，可以在 ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"MYGaFQhKin"},{"type":"inlineCode","value":"IFreqaiModel","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"BxowfnNw7H"},{"type":"text","value":" 中覆盖 ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"A91yOFnV8h"},{"type":"inlineCode","value":"define_data_pipeline","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"Z2e2xF4Naa"},{"type":"text","value":"/","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"NgRSWt8GjK"},{"type":"inlineCode","value":"define_label_pipeline","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"yJgRL6RLVG"},{"type":"text","value":" 函数：","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"YhP2KPNHus"}],"key":"DkzlGEEAJI"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"更多信息可用","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"sgAIvFdhwu"}],"key":"mOUkvnqAmg"},{"type":"paragraph","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"text","value":"FreqAI 使用 ","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"S5hnEqYSWS"},{"type":"link","url":"https://github.com/emergentmethods/datasieve","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"inlineCode","value":"DataSieve","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"a7zUm5tuIp"}],"urlSource":"https://github.com/emergentmethods/datasieve","error":true,"key":"EtJjVAcqdI"},{"type":"text","value":" 管道，它遵循 SKlearn 管道 API，但添加了 X、y 和 sample_weight 向量点移除、特征移除、特征名称跟踪等功能。","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"gD3gayKMeG"}],"key":"egvXoK8yXf"}],"key":"FJObUIgcjX"},{"type":"code","lang":"python","value":"from datasieve.transforms import SKLearnWrapper, DissimilarityIndex\nfrom datasieve.pipeline import Pipeline\nfrom sklearn.preprocessing import QuantileTransformer, StandardScaler\nfrom freqai.base_models import BaseRegressionModel\n\n\nclass MyFreqaiModel(BaseRegressionModel):\n    \"\"\"\n    一些很酷的自定义模型\n    \"\"\"\n    def fit(self, data_dictionary: Dict, dk: FreqaiDataKitchen, **kwargs) -> Any:\n        \"\"\"\n        我的自定义拟合函数\n        \"\"\"\n        model = cool_model.fit()\n        return model\n\n    def define_data_pipeline(self) -> Pipeline:\n        \"\"\"\n        用户在此定义其自定义特征管道（如果他们希望）\n        \"\"\"\n        feature_pipeline = Pipeline([\n            ('qt', SKLearnWrapper(QuantileTransformer(output_distribution='normal'))),\n            ('di', ds.DissimilarityIndex(di_threshold=1))\n        ])\n\n        return feature_pipeline\n    \n    def define_label_pipeline(self) -> Pipeline:\n        \"\"\"\n        用户在此定义其自定义标签管道（如果他们希望）\n        \"\"\"\n        label_pipeline = Pipeline([\n            ('qt', SKLearnWrapper(StandardScaler())),\n        ])\n\n        return label_pipeline","position":{"start":{"line":230,"column":1},"end":{"line":268,"column":1}},"key":"NxOP4oG09t"},{"type":"paragraph","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"在这里，您定义了在训练和预测期间将用于特征集的确切管道。您可以通过将 ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"C7bAwj5cba"},{"type":"inlineCode","value":"SKLearnWrapper","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"AZClC30uRs"},{"type":"text","value":" 类包装在 ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"noWOaE6gF2"},{"type":"inlineCode","value":"SKLearnWrapper","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"HLW164ezjm"},{"type":"text","value":" 中，如上所示，使用","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"LbDV5f6veA"},{"type":"emphasis","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"text","value":"大多数","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"ddt6uwKPvA"}],"key":"axVJAFiyo3"},{"type":"text","value":" SKLearn 转换步骤。此外，您可以使用 ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"OOOQXdsH0W"},{"type":"link","url":"https://github.com/emergentmethods/datasieve","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"children":[{"type":"inlineCode","value":"DataSieve","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"RJWO7pMaYc"},{"type":"text","value":" 库","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"lH6o7aoQwO"}],"urlSource":"https://github.com/emergentmethods/datasieve","error":true,"key":"FIykeacTqa"},{"type":"text","value":" 中可用的任何转换。","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"GbFum6qcce"}],"key":"i6HXkZWSBq"},{"type":"paragraph","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"children":[{"type":"text","value":"您可以通过创建一个继承自 datasieve ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"yTOGCFB8BV"},{"type":"inlineCode","value":"BaseTransform","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"n3UDjytD4T"},{"type":"text","value":" 的类并实现您的 ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"s234IBWJfW"},{"type":"inlineCode","value":"fit()","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"WfIWLkA4my"},{"type":"text","value":"、","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"qm9gupC9Eu"},{"type":"inlineCode","value":"transform()","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"xVL7jeRLkp"},{"type":"text","value":" 和 ","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"Wzyk98fpux"},{"type":"inlineCode","value":"inverse_transform()","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"b9sctUJuOb"},{"type":"text","value":" 方法来轻松添加自己的转换：","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"YXsmTIG6Ty"}],"key":"usBbB2QL8F"},{"type":"code","lang":"python","value":"from datasieve.transforms.base_transform import BaseTransform\n# 导入您需要的其他内容\n\nclass MyCoolTransform(BaseTransform):\n    def __init__(self, **kwargs):\n        self.param1 = kwargs.get('param1', 1)\n\n    def fit(self, X, y=None, sample_weight=None, feature_list=None, **kwargs):\n        # 对 X、y、sample_weight 或/和 feature_list 进行一些操作\n        return X, y, sample_weight, feature_list\n\n    def transform(self, X, y=None, sample_weight=None,\n                  feature_list=None, outlier_check=False, **kwargs):\n        # 对 X、y、sample_weight 或/和 feature_list 进行一些操作\n        return X, y, sample_weight, feature_list\n\n    def inverse_transform(self, X, y=None, sample_weight=None, feature_list=None, **kwargs):\n        # 对 X、y、sample_weight 或/和 feature_list 进行一些操作\n        return X, y, sample_weight, feature_list","position":{"start":{"line":274,"column":1},"end":{"line":294,"column":1}},"key":"XZHV5qLPPl"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"提示","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"N6g3pZMZ4r"}],"key":"ZyVD1nzUUs"},{"type":"paragraph","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"您可以在与 ","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"J7edzQqwqj"},{"type":"inlineCode","value":"IFreqaiModel","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"BVjE7lVbfz"},{"type":"text","value":" 相同的文件中定义此自定义类。","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"Fm70f6aCcI"}],"key":"bfum5m3th8"}],"key":"GhVvcTBiex"},{"type":"heading","depth":4,"position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"text","value":"将自定义 ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"xx8j4JzBc5"},{"type":"inlineCode","value":"IFreqaiModel","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"EO7JtV3h7w"},{"type":"text","value":" 迁移到新管道","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"MT2lvLt8Vb"}],"identifier":"id-ifreqaimodel","label":"将自定义 IFreqaiModel 迁移到新管道","html_id":"id-ifreqaimodel","implicit":true,"key":"uWg6xUofbH"},{"type":"paragraph","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"如果您创建了自己的自定义 ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"lqZjIzm7qS"},{"type":"inlineCode","value":"IFreqaiModel","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"agK1Q8zsMn"},{"type":"text","value":"，并且仍然依赖 ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"pszjwx2ut3"},{"type":"inlineCode","value":"data_cleaning_train/predict()","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"AmQt101zXk"},{"type":"text","value":"，则需要迁移到新管道。如果您的模型","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"TmY8354ndU"},{"type":"emphasis","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"text","value":"不","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"FYLZOigGNN"}],"key":"EDXKLgMuWV"},{"type":"text","value":"依赖 ","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"z1uQwtQFMd"},{"type":"inlineCode","value":"data_cleaning_train/predict()","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"HRP99QpsAv"},{"type":"text","value":"，则无需担心此迁移。","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"LAxsHDHILJ"}],"key":"oFjd6JWZCJ"},{"type":"paragraph","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"有关迁移的更多详细信息，请参见","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"umA8nl7NyE"},{"type":"crossReference","url":"/strategy-migration","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"text","value":"此处","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"q5VA5KPGBV"}],"urlSource":"strategy_migration.md#freqai---new-data-pipeline","dataUrl":"/strategy-migration.json","identifier":"freqai---new-data-pipeline","label":"freqai---new-data-pipeline","remote":true,"protocol":"file","key":"Pf9cHtaMin"},{"type":"text","value":"。","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"YxBp8sOf46"}],"key":"vo9ysETgoS"},{"type":"heading","depth":3,"position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"text","value":"异常值检测","position":{"start":{"line":306,"column":1},"end":{"line":306,"column":1}},"key":"CDkPJf9pyE"}],"identifier":"id","label":"异常值检测","html_id":"id-6","implicit":true,"key":"JMIougjE9U"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"股票和加密市场在异常数据点形式中存在大量非模式噪声。FreqAI 实现了多种方法来识别此类异常值，从而降低风险。","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"zLXAZAx5YU"}],"key":"Iyee1hXZ73"},{"type":"heading","depth":4,"position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"children":[{"type":"text","value":"使用 Dissimilarity Index (DI) 识别异常值","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"BMbs663mxb"}],"identifier":"id-dissimilarity-index-di","label":"使用 Dissimilarity Index (DI) 识别异常值","html_id":"id-dissimilarity-index-di","implicit":true,"key":"eIWqcdhBE6"},{"type":"paragraph","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"Dissimilarity Index (DI) 旨在量化与模型做出的每个预测相关的不确定性。","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"QEUgXEM69t"}],"key":"Pqn3p9bOjF"},{"type":"paragraph","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"您可以通过在配置中包含以下语句，告诉 FreqAI 使用 DI 从训练/测试数据集中移除异常数据点：","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"jzcGUxHMaQ"}],"key":"PKFMZxPLog"},{"type":"code","lang":"json","value":"    \"freqai\": {\n        \"feature_parameters\" : {\n            \"DI_threshold\": 1\n        }\n    }","position":{"start":{"line":316,"column":1},"end":{"line":322,"column":1}},"key":"e1ORzYfZiM"},{"type":"paragraph","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"这将向您的 ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"MKZXniNqXD"},{"type":"inlineCode","value":"feature_pipeline","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"xz72WFNW7h"},{"type":"text","value":" 添加 ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"UA0624XT6H"},{"type":"inlineCode","value":"DissimilarityIndex","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"rMmqpAodWd"},{"type":"text","value":" 步骤，并将阈值设置为 1。DI 允许由于低确定性而丢弃异常值（在模型特征空间中不存在）的预测。为此，FreqAI 测量每个训练数据点（特征向量）","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"eTVwMAxOVr"},{"type":"inlineMath","value":"X_{a}","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>a</mi></msub></mrow><annotation encoding=\"application/x-tex\">X_{a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"ujKF57TAiy"},{"type":"text","value":" 与所有其他训练数据点之间的距离：","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"LS6qIe5tP4"}],"key":"P0aK7s6UY9"},{"type":"math","value":"d_{ab} = \\sqrt{\\sum_{j=1}^p(X_{a,j}-X_{b,j})^2}","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>d</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>p</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>X</mi><mrow><mi>a</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>−</mo><msub><mi>X</mi><mrow><mi>b</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">d_{ab} = \\sqrt{\\sum_{j=1}^p(X_{a,j}-X_{b,j})^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ab</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.34em;vertical-align:-1.4138em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9263em;\"><span class=\"svg-align\" style=\"top:-5.3em;\"><span class=\"pstrut\" style=\"height:5.3em;\"></span><span class=\"mord\" style=\"padding-left:1.056em;\"><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6985em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3471em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.8863em;\"><span class=\"pstrut\" style=\"height:5.3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.742em;height:3.38em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='3.38em' viewBox='0 0 400000 3380' preserveAspectRatio='xMinYMin slice'><path d='M702 80H40000040\nH742v3246l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\n219 661 l218 661zM702 80H400000v40H742z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4138em;\"><span></span></span></span></span></span></span></span></span></span>","enumerator":"2","key":"Z1YyFjgbca"},{"type":"paragraph","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"text","value":"其中 ","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"dzHn5wUNay"},{"type":"inlineMath","value":"d_{ab}","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>d</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">d_{ab}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ab</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"zGT9jCBWyr"},{"type":"text","value":" 是归一化点 ","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"UudY6NOi05"},{"type":"inlineMath","value":"a","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"j7CTNQStZJ"},{"type":"text","value":" 和 ","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"MjwrTBtGwT"},{"type":"inlineMath","value":"b","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"EfGYD50Aqv"},{"type":"text","value":" 之间的距离，","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"gcUvQwfkqi"},{"type":"inlineMath","value":"p","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span>","key":"FeVWgCsez0"},{"type":"text","value":" 是特征的数量，即向量 ","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"w1LKw9JD7O"},{"type":"inlineMath","value":"X","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>X</mi></mrow><annotation encoding=\"application/x-tex\">X</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span></span></span></span>","key":"Fi3uosTwbb"},{"type":"text","value":" 的长度。特征距离 ","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"WEf34ABYjV"},{"type":"inlineMath","value":"\\overline{d}","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>d</mi><mo stretchy=\"true\">‾</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\overline{d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8944em;\"></span><span class=\"mord overline\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.8144em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"overline-line\" style=\"border-bottom-width:0.04em;\"></span></span></span></span></span></span></span></span></span>","key":"WyFpdSqacK"},{"type":"text","value":" 对于一组训练数据点，简单地是平均距离的平均值：","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"xKfMF0RAUw"}],"key":"wv2ErnXTDG"},{"type":"math","value":"\\overline{d} = \\sum_{a=1}^n(\\sum_{b=1}^n(d_{ab}/n)/n)","position":{"start":{"line":330,"column":1},"end":{"line":330,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>d</mi><mo stretchy=\"true\">‾</mo></mover><mo>=</mo><munderover><mo>∑</mo><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><munderover><mo>∑</mo><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>d</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mi mathvariant=\"normal\">/</mi><mi>n</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">/</mi><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\overline{d} = \\sum_{a=1}^n(\\sum_{b=1}^n(d_{ab}/n)/n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8944em;\"></span><span class=\"mord overline\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.8144em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"overline-line\" style=\"border-bottom-width:0.04em;\"></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9535em;vertical-align:-1.3021em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8479em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">b</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3021em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ab</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span></span>","enumerator":"3","key":"Imk8xbe5C5"},{"type":"paragraph","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"inlineMath","value":"\\overline{d}","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>d</mi><mo stretchy=\"true\">‾</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\overline{d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8944em;\"></span><span class=\"mord overline\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.8144em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"overline-line\" style=\"border-bottom-width:0.04em;\"></span></span></span></span></span></span></span></span></span>","key":"xVpTLeEKjp"},{"type":"text","value":" 量化了训练数据的分布，与新的预测特征向量 ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"jX7UhC3G4p"},{"type":"inlineMath","value":"X_k","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>X</mi><mi>k</mi></msub></mrow><annotation encoding=\"application/x-tex\">X_k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"cqNyxriAll"},{"type":"text","value":" 和所有训练数据之间的距离进行比较：","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"fSDFQTNS8V"}],"key":"DNsrUma68j"},{"type":"math","value":"d_k = \\arg \\min d_{k,i}","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>d</mi><mi>k</mi></msub><mo>=</mo><mi>arg</mi><mo>⁡</mo><mi>min</mi><mo>⁡</mo><msub><mi>d</mi><mrow><mi>k</mi><mo separator=\"true\">,</mo><mi>i</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">d_k = \\arg \\min d_{k,i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mop\">ar<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">min</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span></span></span>","enumerator":"4","key":"DnNkiUaDRL"},{"type":"paragraph","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"children":[{"type":"text","value":"这使 Dissimilarity Index 的估计成为可能：","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"pUGkcmSDAv"}],"key":"zX4ohuJepd"},{"type":"math","value":"DI_k = d_k/\\overline{d}","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>D</mi><msub><mi>I</mi><mi>k</mi></msub><mo>=</mo><msub><mi>d</mi><mi>k</mi></msub><mi mathvariant=\"normal\">/</mi><mover accent=\"true\"><mi>d</mi><mo stretchy=\"true\">‾</mo></mover></mrow><annotation encoding=\"application/x-tex\">DI_k = d_k/\\overline{d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1444em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord overline\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.8144em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"overline-line\" style=\"border-bottom-width:0.04em;\"></span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"ZikYGe5MbR"},{"type":"paragraph","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"text","value":"您可以通过 ","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"RExh0GLX7U"},{"type":"inlineCode","value":"DI_threshold","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"iCEQ4l1MVJ"},{"type":"text","value":" 调整 DI，以增加或减少训练模型的推断。较高的 ","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"pH4g3FbKKF"},{"type":"inlineCode","value":"DI_threshold","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"JWrgeuqyFB"},{"type":"text","value":" 意味着 DI 更宽松，允许使用远离训练数据的预测，而较低的 ","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"KXkJ8Mxjck"},{"type":"inlineCode","value":"DI_threshold","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"mGGLMoxkjj"},{"type":"text","value":" 则相反，因此丢弃更多预测。","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"vFG8aNOKbF"}],"key":"kCWBXMZeZw"},{"type":"paragraph","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"text","value":"下图描述了 3D 数据集的 DI。","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"zjkkyD1bZg"}],"key":"GdRFMC1yMz"},{"type":"image","url":"/build/freqai_DI-72b12188594ba107e2c959e869195063.jpg","alt":"DI","position":{"start":{"line":344,"column":1},"end":{"line":344,"column":1}},"key":"OdDRGq0zPm","urlSource":"assets/freqai_DI.jpg","urlOptimized":"/build/freqai_DI-72b12188594ba107e2c959e869195063.webp"},{"type":"heading","depth":4,"position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"children":[{"type":"text","value":"使用支持向量机 (SVM) 识别异常值","position":{"start":{"line":346,"column":1},"end":{"line":346,"column":1}},"key":"uQ2XKBoUZ2"}],"identifier":"id-svm","label":"使用支持向量机 (SVM) 识别异常值","html_id":"id-svm","implicit":true,"key":"w00dJMmnTv"},{"type":"paragraph","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"children":[{"type":"text","value":"您可以通过在配置中包含以下语句，告诉 FreqAI 使用支持向量机 (SVM) 从训练/测试数据集中移除异常数据点：","position":{"start":{"line":348,"column":1},"end":{"line":348,"column":1}},"key":"BaxtVDWlYG"}],"key":"HGCAtXNXF5"},{"type":"code","lang":"json","value":"    \"freqai\": {\n        \"feature_parameters\" : {\n            \"use_SVM_to_remove_outliers\": true\n        }\n    }","position":{"start":{"line":350,"column":1},"end":{"line":356,"column":1}},"key":"tarEFfG7xu"},{"type":"paragraph","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"children":[{"type":"text","value":"这将向您的 ","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"F05Sj22tep"},{"type":"inlineCode","value":"feature_pipeline","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"COF3l8VMdl"},{"type":"text","value":" 添加 ","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"KfoT5XAQuJ"},{"type":"inlineCode","value":"SVMOutlierExtractor","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"jsIptKN9iy"},{"type":"text","value":" 步骤。SVM 将在训练数据上训练，任何 SVM 认为超出特征空间的数据点将被移除。","position":{"start":{"line":358,"column":1},"end":{"line":358,"column":1}},"key":"zNHmwViN58"}],"key":"ocOEHSGKsR"},{"type":"paragraph","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"children":[{"type":"text","value":"您可以通过 ","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"KZSFgeSzvJ"},{"type":"inlineCode","value":"feature_parameters.svm_params","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"pTzuKSzY4S"},{"type":"text","value":" 字典在配置中为 SVM 提供其他参数，例如 ","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"mS7YjkEhSX"},{"type":"inlineCode","value":"shuffle","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"ccn109Ujjm"},{"type":"text","value":" 和 ","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"Bvya3jskY4"},{"type":"inlineCode","value":"nu","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"ujAobfPfbC"},{"type":"text","value":"。","position":{"start":{"line":360,"column":1},"end":{"line":360,"column":1}},"key":"JBsxUeEOo9"}],"key":"DUyXfrZp6d"},{"type":"paragraph","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"children":[{"type":"text","value":"参数 ","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"Q44uaZFYu5"},{"type":"inlineCode","value":"shuffle","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"ju4wjHQfW7"},{"type":"text","value":" 默认设置为 ","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"mU8foudLXk"},{"type":"inlineCode","value":"False","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"q7lbQXy5mi"},{"type":"text","value":" 以确保一致的结果。如果设置为 ","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"lMq5LQVgMC"},{"type":"inlineCode","value":"True","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"bppzCokFil"},{"type":"text","value":"，在同一数据集上多次运行 SVM 可能会导致不同的结果，因为 ","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"IzjSiTCSaq"},{"type":"inlineCode","value":"max_iter","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"SrgLx9Sqg0"},{"type":"text","value":" 太低，算法无法达到所需的 ","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"hUtEmG1abe"},{"type":"inlineCode","value":"tol","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"zx5wEvVacc"},{"type":"text","value":"。增加 ","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"m3yy0WSDsT"},{"type":"inlineCode","value":"max_iter","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"VOr83JLnZj"},{"type":"text","value":" 可以解决此问题，但会导致过程花费更长时间。","position":{"start":{"line":362,"column":1},"end":{"line":362,"column":1}},"key":"Dou9PznJbL"}],"key":"uV6FEPT3N6"},{"type":"paragraph","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"children":[{"type":"text","value":"参数 ","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"skdx01iFSi"},{"type":"inlineCode","value":"nu","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"PnyDniJLXy"},{"type":"text","value":"，","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"xA7tnz4iSv"},{"type":"emphasis","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"children":[{"type":"text","value":"非常","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"lH7S2fJzUu"}],"key":"thPsogKwMl"},{"type":"text","value":"广泛地说，是应该被视为异常值的数据点的数量，应该在 0 和 1 之间。","position":{"start":{"line":364,"column":1},"end":{"line":364,"column":1}},"key":"k8dZCixz1l"}],"key":"ubpm2PlWx2"},{"type":"heading","depth":4,"position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"children":[{"type":"text","value":"使用 DBSCAN 识别异常值","position":{"start":{"line":366,"column":1},"end":{"line":366,"column":1}},"key":"HjLyXUHuW3"}],"identifier":"id-dbscan","label":"使用 DBSCAN 识别异常值","html_id":"id-dbscan","implicit":true,"key":"mgCpnbXjvf"},{"type":"paragraph","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"children":[{"type":"text","value":"您可以通过在配置中激活 ","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"rwERBWsMEd"},{"type":"inlineCode","value":"use_DBSCAN_to_remove_outliers","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"NXUGbRGnWp"},{"type":"text","value":" 来配置 FreqAI 使用 DBSCAN 对训练/测试数据集或传入的预测异常值进行聚类和移除：","position":{"start":{"line":368,"column":1},"end":{"line":368,"column":1}},"key":"CrrETJf2oz"}],"key":"MkaURPmQrZ"},{"type":"code","lang":"json","value":"    \"freqai\": {\n        \"feature_parameters\" : {\n            \"use_DBSCAN_to_remove_outliers\": true\n        }\n    }","position":{"start":{"line":370,"column":1},"end":{"line":376,"column":1}},"key":"mDf4Ac56kD"},{"type":"paragraph","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"children":[{"type":"text","value":"这将向您的 ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"UdGPge6viA"},{"type":"inlineCode","value":"feature_pipeline","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"Wtl1u66uNi"},{"type":"text","value":" 添加 ","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"ozKEkVAKDB"},{"type":"inlineCode","value":"DataSieveDBSCAN","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"y8r2RVABsn"},{"type":"text","value":" 步骤。这是一种无监督机器学习算法，可以在不需要知道应该有多少个聚类的情况下对数据进行聚类。","position":{"start":{"line":378,"column":1},"end":{"line":378,"column":1}},"key":"u8QwKOYoTw"}],"key":"B6zk1uqzHX"},{"type":"paragraph","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"给定数据点数量 ","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"mYqhEgIZP7"},{"type":"inlineMath","value":"N","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"sz6Tmq4oRt"},{"type":"text","value":" 和距离 ","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"KRlsubBVSv"},{"type":"inlineMath","value":"\\varepsilon","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">\\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span>","key":"fnhZGtQLRS"},{"type":"text","value":"，DBSCAN 通过将所有在距离 ","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"g3vgJ3V6mH"},{"type":"inlineMath","value":"\\varepsilon","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">\\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span>","key":"EGszZZVc6B"},{"type":"text","value":" 内有 ","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"pEwzIwAWzz"},{"type":"inlineMath","value":"N-1","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">N-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"OdZgQZZyIo"},{"type":"text","value":" 个其他数据点的数据点设置为","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"xKlocGETuP"},{"type":"emphasis","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"核心点","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"kUCPymnju1"}],"key":"vzEWrPuoae"},{"type":"text","value":"来对数据集进行聚类。在距离 ","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"Yk6K2CdfS6"},{"type":"inlineMath","value":"\\varepsilon","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">\\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span>","key":"J8QBCWvTOp"},{"type":"text","value":" 内有一个","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"egbiGLbo4T"},{"type":"emphasis","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"核心点","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"gJMYd9w73c"}],"key":"HdB9Dyl2y9"},{"type":"text","value":"但在距离 ","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"lXXEVLSD7m"},{"type":"inlineMath","value":"\\varepsilon","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">\\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span>","key":"qzmoBV2WVg"},{"type":"text","value":" 内没有 ","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"aKD9rkTtfI"},{"type":"inlineMath","value":"N-1","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">N-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"jAsuAWyv1d"},{"type":"text","value":" 个其他数据点的数据点被视为","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"iC3v0X2Y26"},{"type":"emphasis","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"边缘点","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"KDISlnc0BT"}],"key":"kDipO7pEGD"},{"type":"text","value":"。聚类是","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"eHt6PYIzmw"},{"type":"emphasis","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"核心点","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"lGmGNj7onL"}],"key":"A3srlY1iLa"},{"type":"text","value":"和","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"GsxPWvuarR"},{"type":"emphasis","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"边缘点","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"pwRcCN76wp"}],"key":"exrUbmH96v"},{"type":"text","value":"的集合。在距离 ","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"FbFKAXq1uv"},{"type":"inlineMath","value":"<\\varepsilon","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>&lt;</mo><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">&lt;\\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span>","key":"H3s71xj6MO"},{"type":"text","value":" 内没有其他数据点的数据点被视为异常值。下图显示了 ","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"Fv1UeXlH1m"},{"type":"inlineMath","value":"N = 3","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding=\"application/x-tex\">N = 3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3</span></span></span></span>","key":"AwZOoF1XB3"},{"type":"text","value":" 的聚类。","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"VeGIFi9wtq"}],"key":"a6TQALiNdX"},{"type":"image","url":"/build/freqai_dbscan-d205ead90ab34b12c19ef11548f1cd3e.jpg","alt":"dbscan","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"key":"u1RLpr8KGx","urlSource":"assets/freqai_dbscan.jpg","urlOptimized":"/build/freqai_dbscan-d205ead90ab34b12c19ef11548f1cd3e.webp"},{"type":"paragraph","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"FreqAI 使用 ","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"R5uosiIj9G"},{"type":"inlineCode","value":"sklearn.cluster.DBSCAN","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"OdNZdGhLsz"},{"type":"text","value":"（详细信息可在 scikit-learn 的网页上找到","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"nAXpVrEvsv"},{"type":"link","url":"https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"此处","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"IIngec94XL"}],"urlSource":"https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html","key":"SoB3zahjXu"},{"type":"text","value":"（外部网站）），其中 ","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"t1pJmp6cQz"},{"type":"inlineCode","value":"min_samples","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"e4ubWFURhO"},{"type":"text","value":"（","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"OmBoG2veYE"},{"type":"inlineMath","value":"N","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"Y5EzhO9qDb"},{"type":"text","value":"）取为特征集中时间点（蜡烛）数量的 1/4。","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"afeElqGvea"},{"type":"inlineCode","value":"eps","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"N1oVuCTdRd"},{"type":"text","value":"（","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"KD0wHK5fnF"},{"type":"inlineMath","value":"\\varepsilon","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">\\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span>","key":"VraeCtv77F"},{"type":"text","value":"）自动计算为从特征集中所有数据点的成对距离中最近邻计算的","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"pyPl8MahCj"},{"type":"emphasis","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"text","value":"k-距离图","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"FYcwgxZJ7U"}],"key":"dx1f0ds4St"},{"type":"text","value":"中的肘点。","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"tyuQ27RmQf"}],"key":"Em5RFRPPaY"},{"type":"heading","depth":4,"position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"text","value":"使用主成分分析进行数据降维","position":{"start":{"line":386,"column":1},"end":{"line":386,"column":1}},"key":"ba9xNwdcZa"}],"identifier":"id","label":"使用主成分分析进行数据降维","html_id":"id-7","implicit":true,"key":"u0maCztjad"},{"type":"paragraph","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"children":[{"type":"text","value":"您可以通过在配置中激活 ","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"uLcP9ib5zh"},{"type":"inlineCode","value":"principal_component_analysis","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"goiFxZXIWN"},{"type":"text","value":" 来降低特征的维度：","position":{"start":{"line":388,"column":1},"end":{"line":388,"column":1}},"key":"yp6HDvvLr0"}],"key":"byimwcU0WH"},{"type":"code","lang":"json","value":"    \"freqai\": {\n        \"feature_parameters\" : {\n            \"principal_component_analysis\": true\n        }\n    }","position":{"start":{"line":390,"column":1},"end":{"line":396,"column":1}},"key":"I3PFKFy6qD"},{"type":"paragraph","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"children":[{"type":"text","value":"这将对特征执行 PCA 并降低其维度，使数据集的解释方差 >= 0.999。降低数据维度使训练模型更快，因此允许更最新的模型。","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"key":"iKrQEDruXg"}],"key":"UnidHnShsN"}],"key":"NlfcEV6JtV"}],"key":"uiySTpL54X"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"FreqAI 参数表","short_title":"参数表","url":"/freqai-parameter-table","group":"FreqAI"},"next":{"title":"FreqAI 运行指南","short_title":"FreqAI 运行","url":"/freqai-running","group":"FreqAI"}}},"domain":"http://localhost:3002"}