{"version":2,"kind":"Article","sha256":"ecfbc30398576b8afece2d730a4774abf69dbbbc710de038fdb1eacd6ded4878","slug":"lookahead-analysis","location":"/lookahead-analysis.md","dependencies":[],"frontmatter":{"title":"前瞻性分析指南","description":"前瞻性分析是一个用于检测和验证交易策略中是否存在前瞻性偏差的工具。本文档详细介绍了如何使用该工具来确保策略的有效性。","short_title":"前瞻性分析","subtitle":"验证策略中的前瞻性偏差","subject":"Freqtrade 前瞻性分析","authors":[{"id":"Freqtrade","name":"Freqtrade"}],"github":"https://github.com/freqtrade-cn/docs_zh-CN","keywords":["Freqtrade","中文文档","交易机器人","量化交易","加密货币","数字货币","区块链","人工智能","机器学习"],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/freqtrade-cn/docs_zh-CN/blob/main/lookahead-analysis.md","exports":[{"format":"md","filename":"lookahead-analysis.md","url":"/lookahead-analysis-9c3d95fa7394e89c6f8ce1e2c51a1f2d.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"前瞻性分析","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"hwkWHvrkTQ"}],"identifier":"id","label":"前瞻性分析","html_id":"id","implicit":true,"key":"I7ET4UIXdg"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"本页解释了如何验证你的策略是否存在前瞻性偏差。","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"qzYEaBY3as"}],"key":"NoYLnusKfZ"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"前瞻性偏差是任何策略的祸根，因为有时很容易引入这种偏差，但可能很难发现。","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"D1fQUfbFxB"}],"key":"EqmSacmeBH"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"回测会初始化所有时间戳（将整个数据框加载到内存中）并一次性计算所有指标。\n这意味着如果你的指标或入场/出场信号查看未来的蜡烛图，这将使你的回测结果失真。","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Rqq1loyYTi"}],"key":"kxDwOUENL6"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"inlineCode","value":"lookahead-analysis","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"jruh5IjzfV"},{"type":"text","value":" 命令需要历史数据可用。\n要了解如何获取你感兴趣的交易对和交易所的数据，\n请查看文档的","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"GTvAFfMmjL"},{"type":"link","url":"/data-download","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"数据下载","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"ZPZ31FbDGt"}],"urlSource":"data-download.md","dataUrl":"/data-download.json","internal":true,"protocol":"file","key":"CVnTG4MXPw"},{"type":"text","value":"部分。\n","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"dJAKtYgVmc"},{"type":"inlineCode","value":"lookahead-analysis","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"Z0J2BHCPl7"},{"type":"text","value":" 也支持 freqai 策略。","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"a6Mos285cn"}],"key":"AAslMTxfc9"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"该命令在内部链接回测并探测策略以触发前瞻性偏差。\n这是通过不查看策略代码本身，而是通过比较完整回测中改变的指标值和移动的入场/出场点来实现的。","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"DqAnlEq2BG"}],"key":"omMBZ31Jc0"},{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"inlineCode","value":"lookahead-analysis","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"VnsTf9diRS"},{"type":"text","value":" 可以使用","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"O5QeInv9ZS"},{"type":"link","url":"/backtesting","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"回测","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"sTMNYsVMDX"}],"urlSource":"backtesting.md","dataUrl":"/backtesting.json","internal":true,"protocol":"file","key":"cugd6NCSVS"},{"type":"text","value":"的典型选项，但强制使用以下选项：","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"lLWVGxoEz8"}],"key":"tKWSCV4PV4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":28,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"inlineCode","value":"--cache","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"BiceWMHAVy"},{"type":"text","value":" 强制设置为 “none”。","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"RtNf8fTR1r"}],"key":"MdkBa1oPWm"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"inlineCode","value":"--max-open-trades","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"MB1GDVlCrJ"},{"type":"text","value":" 强制至少等于交易对数量。","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"uGczz9xyOL"}],"key":"QpiCD0HMJZ"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"inlineCode","value":"--dry-run-wallet","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"F4LNNdeM28"},{"type":"text","value":" 强制设置为基本无限（10亿）。","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"aCAUSrFXVE"}],"key":"L7JLgAytDU"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"inlineCode","value":"--stake-amount","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"PP7IwjkR5O"},{"type":"text","value":" 强制设置为静态 10000（1万）。","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"B2s11afihE"}],"key":"jJsUM6CXmI"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"inlineCode","value":"--enable-protections","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"b48uSTTrJe"},{"type":"text","value":" 强制关闭。","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"hJ3OVX9TrQ"}],"key":"LS617UxAYQ"}],"key":"dqLrPLjyD7"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"这些设置是为了避免用户意外产生误报。","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"nqQENHjpHw"}],"key":"EYDTLytdh1"},{"type":"heading","depth":3,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"lookahead-analysis 命令参考","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"Jetpc3Jxqw"}],"identifier":"lookahead-analysis","label":"lookahead-analysis 命令参考","html_id":"lookahead-analysis","implicit":true,"key":"dbOjB1FYC0"},{"type":"include","file":"commands/lookahead-analysis.md","literal":false,"lang":"markdown","children":[{"type":"code","lang":"","value":"用法: freqtrade lookahead-analysis [-h] [-v] [--no-color] [--logfile FILE]\n                                    [-V] [-c PATH] [-d PATH] [--userdir PATH]\n                                    [-s NAME] [--strategy-path PATH]\n                                    [--recursive-strategy-search]\n                                    [--freqaimodel NAME]\n                                    [--freqaimodel-path PATH] [-i TIMEFRAME]\n                                    [--timerange TIMERANGE]\n                                    [--data-format-ohlcv {json,jsongz,feather,parquet}]\n                                    [--max-open-trades INT]\n                                    [--stake-amount STAKE_AMOUNT]\n                                    [--fee FLOAT] [-p PAIRS [PAIRS ...]]\n                                    [--enable-protections]\n                                    [--dry-run-wallet DRY_RUN_WALLET]\n                                    [--timeframe-detail TIMEFRAME_DETAIL]\n                                    [--strategy-list STRATEGY_LIST [STRATEGY_LIST ...]]\n                                    [--export {none,trades,signals}]\n                                    [--backtest-filename PATH]\n                                    [--backtest-directory PATH]\n                                    [--freqai-backtest-live-models]\n                                    [--minimum-trade-amount INT]\n                                    [--targeted-trade-amount INT]\n                                    [--lookahead-analysis-exportfilename LOOKAHEAD_ANALYSIS_EXPORTFILENAME]\n\n选项:\n  -h, --help            显示帮助信息并退出\n  -i TIMEFRAME, --timeframe TIMEFRAME\n                        指定时间周期（`1m`, `5m`, `30m`, `1h`, `1d`）。\n  --timerange TIMERANGE\n                        指定要使用的数据时间范围。\n  --data-format-ohlcv {json,jsongz,feather,parquet}\n                        下载的蜡烛图（OHLCV）数据的存储格式。\n                        （默认：`feather`）。\n  --max-open-trades INT\n                        覆盖配置设置中的 `max_open_trades` 值。\n  --stake-amount STAKE_AMOUNT\n                        覆盖配置设置中的 `stake_amount` 值。\n  --fee FLOAT           指定手续费比率。将在交易入场和出场时各应用一次。\n  -p PAIRS [PAIRS ...], --pairs PAIRS [PAIRS ...]\n                        限制命令仅处理这些交易对。交易对以空格分隔。\n  --enable-protections, --enableprotections\n                        为回测启用保护措施。这将显著降低回测速度，但会包含已配置的保护措施。\n  --dry-run-wallet DRY_RUN_WALLET, --starting-balance DRY_RUN_WALLET\n                        起始余额，用于回测/超参数优化和模拟运行。\n  --timeframe-detail TIMEFRAME_DETAIL\n                        指定回测的详细时间周期（`1m`, `5m`, `30m`, `1h`, `1d`）。\n  --strategy-list STRATEGY_LIST [STRATEGY_LIST ...]\n                        提供要回测的策略列表，以空格分隔。请注意，时间周期需要在配置中或通过命令行设置。当与 `--export trades` 一起使用时，策略名称会被注入到文件名中（因此 `backtest-data.json` 变为 `backtest-data-SampleStrategy.json`）。\n  --export {none,trades,signals}\n                        导出回测结果（默认：trades）。\n  --backtest-filename PATH, --export-filename PATH\n                        使用此文件名作为回测结果。示例：\n                        `--backtest-filename=backtest_results_2020-09-27_16-20-48.json`。\n                        假设以 `user_data/backtest_results/` 或 `--export-directory` 作为基础目录。\n  --backtest-directory PATH, --export-directory PATH\n                        用于回测结果的目录。示例：\n                        `--export-directory=user_data/backtest_results/`。\n  --minimum-trade-amount INT\n                        前瞻分析的最小交易金额。\n  --targeted-trade-amount INT\n                        前瞻分析的目标交易金额。\n  --lookahead-analysis-exportfilename LOOKAHEAD_ANALYSIS_EXPORTFILENAME\n                        使用此 CSV 文件名存储前瞻分析结果。\n\n通用参数:\n  -v, --verbose         详细模式（-vv 获取更多信息，-vvv 获取所有消息）。\n  --no-color            禁用超参数优化结果的着色。在将输出重定向到文件时可能有用。\n  --logfile FILE, --log-file FILE\n                        记录到指定的文件。特殊值包括：\n                        'syslog', 'journald'。有关更多详细信息，请参阅文档。\n  -V, --version         显示程序版本号并退出\n  -c PATH, --config PATH\n                        指定配置文件（默认：`userdir/config.json` 或 `config.json`，以存在的为准）。\n                        可以使用多个 --config 选项。可以设置为 `-` 以从标准输入读取配置。\n  -d PATH, --datadir PATH, --data-dir PATH\n                        交易所历史回测数据的基本目录路径。要查看期货数据，需要额外使用 trading-mode。\n  --userdir PATH, --user-data-dir PATH\n                        用户数据目录的路径。\n\n策略参数:\n  -s NAME, --strategy NAME\n                        指定机器人使用的策略类名。\n  --strategy-path PATH  指定额外的策略查找路径。\n  --recursive-strategy-search\n                        在策略文件夹中递归搜索策略。\n  --freqaimodel NAME    指定自定义的 freqaimodels。\n  --freqaimodel-path PATH\n                        指定 freqaimodels 的额外查找路径。","position":{"start":{"line":1,"column":1},"end":{"line":89,"column":1}},"key":"MAQatkqFP1"}],"key":"clw1r3bu5C"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"zoawnoY039"}],"key":"GFXDLla6nj"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"上述输出已简化为 ","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"mg2mKx5V67"},{"type":"inlineCode","value":"lookahead-analysis","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"YsHuLjUUG7"},{"type":"text","value":" 在常规回测命令之上添加的选项。","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"efxjB0vEnz"}],"key":"f5Z56hcJvR"}],"key":"rQwNvLO1tA"},{"type":"heading","depth":4,"position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"介绍","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"p3fzT5ubPy"}],"identifier":"id","label":"介绍","html_id":"id-1","implicit":true,"key":"fY1PQ6IISQ"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"许多策略在程序员不知情的情况下都陷入了前瞻性偏差的陷阱。\n这通常会使策略回测看起来有利可图，有时甚至达到极端程度，但这并不现实，因为策略通过查看在模拟或实盘模式下无法获得的数据来\"作弊\"。","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"ecSFEVzbSo"}],"key":"wKS3Dpz7ut"},{"type":"paragraph","position":{"start":{"line":50,"column":1},"end":{"line":52,"column":1}},"children":[{"type":"text","value":"策略可以\"作弊\"的原因是因为 freqtrade 回测过程在开始时就会填充完整的数据框，包括所有蜡烛图时间戳。\n如果程序员不够谨慎或不了解内部工作原理\n（有时这真的很难发现），那么策略就会看到未来的数据。","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"OrVeXgqxq3"}],"key":"AZ1XMwJnm4"},{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"这个命令旨在尝试验证上述前瞻性偏差的有效性。","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"A3gQPRp1JI"}],"key":"FPGet1trvx"},{"type":"heading","depth":4,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"命令如何工作？","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"RY78rdBov9"}],"identifier":"id","label":"命令如何工作？","html_id":"id-2","implicit":true,"key":"qTYSyLiTQX"},{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"它首先会对所有交易对进行回测，为指标和入场/出场生成基准。\n在初始回测运行后，它会检查是否满足 ","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"PWmNKPdPrQ"},{"type":"inlineCode","value":"minimum-trade-amount","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"DzcRzvVHy0"},{"type":"text","value":"，如果不满足则取消该策略的前瞻性分析。\n如果发生这种情况，请使用更宽的时间范围来获取更多交易进行分析，或使用发生更多交易的时间范围。","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"g0bsnmJM2d"}],"key":"wGRBjeD26D"},{"type":"paragraph","position":{"start":{"line":62,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"设置基准后，它将为每个入场和出场分别进行额外的回测运行。\n当这些验证回测完成后，它将比较信号蜡烛图（包括入场和出场）的指标并报告偏差。\n在所有信号都被验证或证伪后，将为用户生成一个结果表。","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"JcUTFFv20X"}],"key":"YdenJE80qM"},{"type":"heading","depth":4,"position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"如何发现和消除偏差？如何挽救有偏差的策略？","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"ElxM9du1HZ"}],"identifier":"id","label":"如何发现和消除偏差？如何挽救有偏差的策略？","html_id":"id-3","implicit":true,"key":"bEkwA25xEm"},{"type":"paragraph","position":{"start":{"line":68,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"如果你在网上发现了一个有偏差的策略，想要获得相同的结果，只是没有偏差，\n那么在大多数情况下你会失望。\n通常策略中的偏差是\"好得难以置信\"的利润的主要驱动因素。\n移除那些因偏差而推高利润的条件或指标通常会使策略显著变差。\n如果偏差指标或条件不是策略的核心，或者\n有其他不带有偏差的入场和出场信号，你可能能够部分挽救它。","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"TD5FbeHGC7"}],"key":"Lr3yPBY9PL"},{"type":"heading","depth":4,"position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"前瞻性偏差的例子","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"NofjRimLby"}],"identifier":"id","label":"前瞻性偏差的例子","html_id":"id-4","implicit":true,"key":"aO4Bd9duX5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":77,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"inlineCode","value":"shift(-10)","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"nJlIQWFgwB"},{"type":"text","value":" 向前看 10 个蜡烛图。","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"BA4rswRmSL"}],"key":"pmQjkCQ61e"},{"type":"listItem","spread":true,"position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"在 populate_* 函数中使用 ","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"yz19N9x5Ei"},{"type":"inlineCode","value":"iloc[]","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"nYjOimmMhx"},{"type":"text","value":" 访问数据框中的特定行。","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"KLSQcU05Nh"}],"key":"D1nvU5xBWB"},{"type":"listItem","spread":true,"position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"如果不严格控制循环的数字，for 循环很容易引入前瞻性偏差。","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"MLkWiVF4Ud"}],"key":"uB4ZGjYtLj"},{"type":"listItem","spread":true,"position":{"start":{"line":80,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"聚合函数如 ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"fkYlJMtJbW"},{"type":"inlineCode","value":".mean()","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"P2Baj8ET7m"},{"type":"text","value":"、","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"P6UaJUTdbn"},{"type":"inlineCode","value":".min()","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"elC5E2Swpi"},{"type":"text","value":" 和 ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"ZTRGztCvhf"},{"type":"inlineCode","value":".max()","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"L41hRzyccq"},{"type":"text","value":"，如果没有滚动窗口，\n将在","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"uMDalo5r3O"},{"type":"strong","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"整个","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"cC80fObx8P"}],"key":"agUKBYCTkV"},{"type":"text","value":"数据框上计算值，因此信号蜡烛图将\"看到\"包含未来蜡烛图的值。\n一个无偏差的例子是使用 ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"UkkXJPk21t"},{"type":"inlineCode","value":"rolling()","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"Y5ooA0VPPk"},{"type":"text","value":" 向后看蜡烛图：\n例如 ","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"DJehLNt7ln"},{"type":"inlineCode","value":"dataframe['volume_mean_12'] = dataframe['volume'].rolling(12).mean()","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"atS0xdv58d"}],"key":"I3q7A7Jobi"},{"type":"listItem","spread":true,"position":{"start":{"line":84,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"inlineCode","value":"ta.MACD(dataframe, 12, 26, 1)","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Haos3l7EIA"},{"type":"text","value":" 在信号周期为 1 时会引入偏差。","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"N8DPICLVTi"}],"key":"XXyX5X5H7L"}],"key":"YJvAwiAzAw"},{"type":"heading","depth":4,"position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"text","value":"结果表中的列是什么意思？","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"SmxTxmekb8"}],"identifier":"id","label":"结果表中的列是什么意思？","html_id":"id-5","implicit":true,"key":"UFMF6UrErU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":88,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"inlineCode","value":"filename","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"za9gJhrCE3"},{"type":"text","value":"：检查的策略文件名","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"v8TeR36ubU"}],"key":"bCpa3a9VQf"},{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"inlineCode","value":"strategy","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"zvqas0fgzD"},{"type":"text","value":"：检查的策略类名","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"IA6h3BJC7C"}],"key":"QBgJ0GA2rV"},{"type":"listItem","spread":true,"position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"inlineCode","value":"has_bias","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"hjauvaPE6a"},{"type":"text","value":"：前瞻性分析的结果。","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"tAkhnGa0ad"},{"type":"inlineCode","value":"No","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"Ga52LJFE7h"},{"type":"text","value":" 表示良好，","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"JR67wSyJMv"},{"type":"inlineCode","value":"Yes","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"jTr4hhLER8"},{"type":"text","value":" 表示不良。","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"W9QxxwocxX"}],"key":"wDCUPEcjPm"},{"type":"listItem","spread":true,"position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"inlineCode","value":"total_signals","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"x2w8jBoNUz"},{"type":"text","value":"：检查的信号数量（默认为 20）","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"l5hSAErdSa"}],"key":"KaBbh3l7O8"},{"type":"listItem","spread":true,"position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"inlineCode","value":"biased_entry_signals","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"uT9pWSwkIb"},{"type":"text","value":"：发现的偏差入场信号数量","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"p8uQqVelKY"}],"key":"RKPRlhM2R7"},{"type":"listItem","spread":true,"position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"inlineCode","value":"biased_exit_signals","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"P4lHkn2Rzv"},{"type":"text","value":"：发现的偏差出场信号数量","position":{"start":{"line":93,"column":1},"end":{"line":93,"column":1}},"key":"eCpIZ0LPau"}],"key":"Zf0ZXQMtJW"},{"type":"listItem","spread":true,"position":{"start":{"line":94,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"inlineCode","value":"biased_indicators","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"Nm6nYu5vTE"},{"type":"text","value":"：显示在 populate_indicators 中定义的指标本身","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"pRQBr0QAjj"}],"key":"dgsHyw4Y0r"}],"key":"CwoPpScsNj"},{"type":"paragraph","position":{"start":{"line":96,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"如果你有与这些出场配对的偏差入场信号，你可能会在 ","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"AOsUA7kLtq"},{"type":"inlineCode","value":"biased_exit_signals","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"t9CJg3uVY2"},{"type":"text","value":" 中得到误报。\n然而，偏差入场通常也会导致偏差出场，\n即使出场本身不产生偏差 -\n特别是如果你的入场和出场条件使用相同的偏差指标。","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"DBgzVpeapK"}],"key":"A8WGsYObqV"},{"type":"paragraph","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"strong","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"首先解决入场偏差，然后解决出场偏差。","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"RpcuwHGivV"}],"key":"NBo1vEW8ti"}],"key":"bfSk2jC47e"},{"type":"heading","depth":4,"position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"注意事项","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"CFvbTxTKNs"}],"identifier":"id","label":"注意事项","html_id":"id-6","implicit":true,"key":"WbViIUFE35"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":105,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":105,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"inlineCode","value":"lookahead-analysis","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"creNP6asZK"},{"type":"text","value":" 只能验证/证伪它计算和验证的交易。\n如果策略有许多不同的信号/信号类型，你需要选择适当的参数以确保所有信号至少触发一次。未触发的信号将不会被验证。\n这将导致假阴性，即策略将被报告为无偏差。","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"o9GPMnTzkg"}],"key":"fDGBK7v9xC"},{"type":"listItem","spread":true,"position":{"start":{"line":108,"column":1},"end":{"line":111,"column":1}},"children":[{"type":"inlineCode","value":"lookahead-analysis","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"w5QdA5eJXg"},{"type":"text","value":" 可以访问相同的回测选项，这可能会引入问题。\n请不要使用任何启用仓位堆叠等选项，因为这会扭曲检查的信号数量。\n如果你决定这样做，请确保你永远不会用完 ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"uOrd8d8BFh"},{"type":"inlineCode","value":"max_open_trades","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"Ftc5GCrzWt"},{"type":"text","value":" 槽位，\n并且在回测钱包配置中有足够的资金。","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"Rp3SQWAjOm"}],"key":"c7jojKCj2y"},{"type":"listItem","spread":true,"position":{"start":{"line":112,"column":1},"end":{"line":114,"column":1}},"children":[{"type":"text","value":"在结果表中，","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"TXoNDY420L"},{"type":"inlineCode","value":"biased_indicators","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"sUyaeA43nl"},{"type":"text","value":" 列\n会错误地将 ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"zajFuFeqKr"},{"type":"inlineCode","value":"set_freqai_targets()","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"aS4CyDAtQz"},{"type":"text","value":" 中定义的 FreqAI 目标指标标记为有偏差。\n","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"EFwSW72dVn"},{"type":"strong","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"这些不是偏差，可以安全地忽略。","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"GyaqZx1V2K"}],"key":"gXjwTKNVBl"}],"key":"VE9JqVWtyx"}],"key":"yJtuCTPG5u"}],"key":"x6uGeKmbzl"}],"key":"qDMVmAjaN9"},"references":{"cite":{"order":[],"data":{}}}}