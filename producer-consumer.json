{"version":2,"kind":"Article","sha256":"c18ffb7a97f45ff4377badba72297b09e22119bfe0f3dbabd02a8a2c58086c01","slug":"producer-consumer","location":"/producer-consumer.md","dependencies":[],"frontmatter":{"title":"生产者/消费者模式","description":"本文档介绍了 Freqtrade 的生产者/消费者模式,包括如何配置多个机器人实例共享计算指标和信号,以及相关的 websocket 设置。","short_title":"生产者/消费者","subtitle":"如何配置和使用生产者/消费者模式","tags":["生产者","消费者","分布式","多实例","WebSocket"],"subject":"Freqtrade 生产者/消费者指南","content_includes_title":false,"authors":[{"id":"Freqtrade","name":"Freqtrade"}],"github":"https://github.com/freqtrade-cn/docs_zh-CN","keywords":["Freqtrade","中文文档","交易机器人","量化交易","加密货币","数字货币","区块链","人工智能","机器学习"],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/freqtrade-cn/docs_zh-CN/blob/main/producer-consumer.md","exports":[{"format":"md","filename":"producer-consumer.md","url":"/build/producer-consumer-8b5c042612d7b086d0ab382722ca6445.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"freqtrade 提供了一种机制，使一个实例（也称为 ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"nKyOd7FTXU"},{"type":"inlineCode","value":"consumer","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"dj7nvaXK8h"},{"type":"text","value":"）可以通过消息 websocket 监听上游 freqtrade 实例（也称为 ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Gc9UVT9CH5"},{"type":"inlineCode","value":"producer","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Z4qDsuubPP"},{"type":"text","value":"）的消息。主要是 ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"YYNpM9GqAe"},{"type":"inlineCode","value":"analyzed_df","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"WzfX8sTyOp"},{"type":"text","value":" 和 ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"SxC3TvzgcY"},{"type":"inlineCode","value":"whitelist","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"A6RiDopUfU"},{"type":"text","value":" 消息。这允许在多个机器人中重用计算出的指标（和信号），而无需多次计算它们。","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"ZPvcxy1vsh"}],"key":"LXmXmH8hqt"},{"type":"paragraph","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"有关设置消息 websocket 的 ","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"P6YI4dxQKG"},{"type":"inlineCode","value":"api_server","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"WUySdE0DUJ"},{"type":"text","value":" 配置（这将是你的生产者），请参阅 Rest API 文档中的","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"X5ZZWDTSpW"},{"type":"crossReference","url":"/rest-api","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"消息 Websocket","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"K0mE15l9Wa"}],"urlSource":"rest-api.md#message-websocket","dataUrl":"/rest-api.json","identifier":"message-websocket","label":"message-websocket","remote":true,"protocol":"file","key":"tkW5kQAuM9"},{"type":"text","value":"。","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"RnNcFqMNgb"}],"key":"PnBFdtvdr7"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"LoudsQdv0g"}],"key":"MoBJPGyT0m"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"我们强烈建议将 ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"XMOYuyvU9n"},{"type":"inlineCode","value":"ws_token","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"uyW27b7WWp"},{"type":"text","value":" 设置为只有你自己知道的随机值，以避免未经授权访问你的机器人。","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"rRgUypGZ7Y"}],"key":"hPh9mKUCJs"}],"key":"AcMUb4PCqW"},{"type":"heading","depth":2,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"配置","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"MMVcaXi8Cb"}],"identifier":"id","label":"配置","html_id":"id","implicit":true,"key":"NwjicqJE3Z"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"通过在消费者的配置文件中添加 ","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"Alsbw9A2op"},{"type":"inlineCode","value":"external_message_consumer","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"ql9GkMl9Gp"},{"type":"text","value":" 部分来启用订阅实例。","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"C2sYd1hEza"}],"key":"U973f8nkFv"},{"type":"code","lang":"json","value":"{\n    //...\n   \"external_message_consumer\": {\n        \"enabled\": true,\n        \"producers\": [\n            {\n                \"name\": \"default\", // 这可以是任何你喜欢的名称，默认为 \"default\"\n                \"host\": \"127.0.0.1\", // 来自你的生产者 api_server 配置的主机\n                \"port\": 8080, // 来自你的生产者 api_server 配置的端口\n                \"secure\": false, // 使用安全 websockets 连接，默认为 false\n                \"ws_token\": \"sercet_Ws_t0ken\" // 来自你的生产者 api_server 配置的 ws_token\n            }\n        ],\n        // 以下配置是可选的，通常不需要\n        // \"wait_timeout\": 300,\n        // \"ping_timeout\": 10,\n        // \"sleep_time\": 10,\n        // \"remove_entry_exit_signals\": false,\n        // \"message_size_limit\": 8\n    }\n    //...\n}","position":{"start":{"line":32,"column":1},"end":{"line":55,"column":1}},"key":"WXkY391u9Q"},{"type":"table","position":{"start":{"line":57,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"参数","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"qe2q3YimJP"}],"key":"w3PHzoUhSv"},{"type":"tableCell","header":true,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"描述","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"GD36lOTmeb"}],"key":"aSTtnBNY1X"}],"key":"Vh7THI9abh"},{"type":"tableRow","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"inlineCode","value":"enabled","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"fzW2l0TIEq"}],"key":"EjQUSRCqRa"},{"type":"tableCell","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"strong","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"必需。","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"rLrIXyT6tJ"}],"key":"phEaaGnMcj"},{"type":"text","value":" 启用消费者模式。如果设置为 false，则忽略此部分中的所有其他设置。","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"gUFQoV14ef"},{"type":"break","key":"qSTun5dymZ"},{"type":"emphasis","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"默认为 ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"nMmJy6M3PP"},{"type":"inlineCode","value":"false","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"iiZlbHqkCu"},{"type":"text","value":"。","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"BYVMaz66N7"}],"key":"Wnadw7rCzr"},{"type":"break","key":"obxCm14epW"},{"type":"text","value":" ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"H7bTw1BZ3w"},{"type":"strong","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"jrHO6oTYjw"}],"key":"ayr0bs7sNT"},{"type":"text","value":" 布尔值。","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"yxuzZyyPWn"}],"key":"eRmVodhMmJ"}],"key":"hufz219mwF"},{"type":"tableRow","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"inlineCode","value":"producers","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"WUxlY8ZbHW"}],"key":"HvRSbUEIld"},{"type":"tableCell","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"strong","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"必需。","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"PWHwp0sSB5"}],"key":"o2TxAHEGJ9"},{"type":"text","value":" 生产者列表 ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"joLscfvplc"},{"type":"break","key":"TL0QX8vfM8"},{"type":"text","value":" ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"yd3YDuSjYm"},{"type":"strong","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"VqchKvDFea"}],"key":"zlL1jIMKoT"},{"type":"text","value":" 数组。","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"Zig9xYbFEB"}],"key":"LtYkP3B4fQ"}],"key":"ryE8qpfp9A"},{"type":"tableRow","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"inlineCode","value":"producers.name","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"y0CmKBAbNW"}],"key":"BGZquSSxCO"},{"type":"tableCell","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"必需。","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"BC2ArQ46Nl"}],"key":"V978WoEoNH"},{"type":"text","value":" 此生产者的名称。如果使用多个生产者，此名称必须用于调用 ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"Cax0wnQOJm"},{"type":"inlineCode","value":"get_producer_pairs()","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"PsimYs65M1"},{"type":"text","value":" 和 ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ZOWXn32psa"},{"type":"inlineCode","value":"get_producer_df()","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"DFGZ0bV71S"},{"type":"text","value":"。","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"omaYqO6dXJ"},{"type":"break","key":"Wo2rJFD7gT"},{"type":"text","value":" ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"dNkrtW7OKC"},{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"khoeNYBw0G"}],"key":"YWrjIGCKPZ"},{"type":"text","value":" 字符串","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"HtNnK141Fm"}],"key":"JzFAqhBiyh"}],"key":"uhz0SadtmP"},{"type":"tableRow","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"inlineCode","value":"producers.host","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"iMM7wcKvWR"}],"key":"otEwXyXfyC"},{"type":"tableCell","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"strong","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"必需。","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"OXSJc5DXor"}],"key":"fnnuQpYxb5"},{"type":"text","value":" 来自你的生产者的主机名或 IP 地址。","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"y4KEMEvphp"},{"type":"break","key":"wP1MAzGDtj"},{"type":"text","value":" ","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"kwzWNgTQ4a"},{"type":"strong","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"pGC93oDw7W"}],"key":"xXNAE2Aqcw"},{"type":"text","value":" 字符串","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"kNmLlcstox"}],"key":"kOMhl3dcO0"}],"key":"yxsitcswra"},{"type":"tableRow","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"inlineCode","value":"producers.port","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"UtZOn5HR5m"}],"key":"x41O8pQPus"},{"type":"tableCell","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"strong","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"必需。","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"SOStuJc2Nv"}],"key":"DN5skQFxqK"},{"type":"text","value":" 与上述主机匹配的端口。","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"HJD2UV40ey"},{"type":"break","key":"DlrMBZqNQ4"},{"type":"emphasis","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"默认为 ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"buXlWbsLLi"},{"type":"inlineCode","value":"8080","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"KgwnF7lS7U"},{"type":"text","value":"。","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"DJfWk67Fta"}],"key":"W40SLAJBRX"},{"type":"break","key":"awY7LlHbwM"},{"type":"text","value":" ","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"uKvh2iAjKv"},{"type":"strong","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"Ncx1kuSxIQ"}],"key":"SZAdKg1vyT"},{"type":"text","value":" 整数","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"ZgHArHtFXT"}],"key":"zm5op0Bx4g"}],"key":"RmfPbQ6pRi"},{"type":"tableRow","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"inlineCode","value":"producers.secure","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"ZdMf4OW5ws"}],"key":"sTdyIkB8vh"},{"type":"tableCell","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"strong","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"可选。","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"louKz9c5Fx"}],"key":"uV3PLmSmQy"},{"type":"text","value":" 在 websockets 连接中使用 ssl。默认为 False。","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"Ch5ng1ozIq"},{"type":"break","key":"Q2gyavXxrg"},{"type":"text","value":" ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"V9XrDf60ng"},{"type":"strong","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"Qnc2V3eBfV"}],"key":"B5PqXmkGdw"},{"type":"text","value":" 字符串","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"t0NsZ4ZDkl"}],"key":"bHyGU8uD0s"}],"key":"GlYLF9yAFH"},{"type":"tableRow","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"inlineCode","value":"producers.ws_token","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"OFmX1SPOeJ"}],"key":"KiWkRDSX7z"},{"type":"tableCell","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"strong","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"必需。","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"wl9nMkf7VM"}],"key":"R30ZBaJnXB"},{"type":"text","value":" 在生产者上配置的 ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"hK87Eh6i4x"},{"type":"inlineCode","value":"ws_token","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"bnsQgSCxWA"},{"type":"text","value":"。","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"IuxJZe4hjt"},{"type":"break","key":"M25tXJvffh"},{"type":"text","value":" ","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"SUeahGiAn0"},{"type":"strong","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"xgYs1DXDOH"}],"key":"ZLmO5taSW2"},{"type":"text","value":" 字符串","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"Ocporbqwea"}],"key":"r6rE74n23u"}],"key":"Y7BUfmV0av"},{"type":"tableRow","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[],"key":"aRGvDR4mqL"},{"type":"tableCell","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"strong","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"可选设置","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"H2n4CctLlC"}],"key":"C6PpTGjlc8"}],"key":"p3T2tySapV"}],"key":"qiVzrw0WBK"},{"type":"tableRow","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"inlineCode","value":"wait_timeout","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"vi0WLanrYT"}],"key":"NiQxy7eP9i"},{"type":"tableCell","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"如果未收到消息，直到我们再次 ping 的超时时间。","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"MZfzOd8r05"},{"type":"break","key":"QrHeQ0u6im"},{"type":"emphasis","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"默认为 ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"tQEyPEf2tf"},{"type":"inlineCode","value":"300","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"oQ2XteY4Ff"},{"type":"text","value":"。","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"Pu8BsJCl9t"}],"key":"RRUTv5t2Dj"},{"type":"break","key":"Uqo43uu27V"},{"type":"text","value":" ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"htK3SSIrMV"},{"type":"strong","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"ByIJkKqtRm"}],"key":"HmSMqQOAFP"},{"type":"text","value":" 整数 - 以秒为单位。","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"mft3UiWxx9"}],"key":"j9SGb4LG8r"}],"key":"tG5cOMD220"},{"type":"tableRow","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"inlineCode","value":"ping_timeout","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"Bnp5raLmg0"}],"key":"DKxvu9TJIJ"},{"type":"tableCell","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"Ping 超时 ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"o9kTMKMyZQ"},{"type":"break","key":"Re0NUGp6j1"},{"type":"emphasis","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"默认为 ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"o8VyZqZrCo"},{"type":"inlineCode","value":"10","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"YvbxgHOedQ"},{"type":"text","value":"。","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"YVhXjH3gaE"}],"key":"AKA1B1J2OD"},{"type":"break","key":"FVzaNh9P1H"},{"type":"text","value":" ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"BAglJFnGr5"},{"type":"strong","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"hDl94WezpG"}],"key":"J7rYTp1yTF"},{"type":"text","value":" 整数 - 以秒为单位。","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"RZJckE5CV2"}],"key":"FduSfru0Y6"}],"key":"xwO60e9MDW"},{"type":"tableRow","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"inlineCode","value":"sleep_time","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"VTAanGuayW"}],"key":"Wy6yA5tcvV"},{"type":"tableCell","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"重试连接前的睡眠时间。","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"XWBGC0wXHj"},{"type":"break","key":"k2VpZqZI8X"},{"type":"emphasis","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"默认为 ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"AT9WuJXd6w"},{"type":"inlineCode","value":"10","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"cWlwXZg4xq"},{"type":"text","value":"。","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"JuIdODLo64"}],"key":"SFzpHUIo2J"},{"type":"break","key":"NtI876ZBuC"},{"type":"text","value":" ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"mWitAlMJID"},{"type":"strong","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"l5M1tcZETa"}],"key":"KFPqQCah9R"},{"type":"text","value":" 整数 - 以秒为单位。","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"eB6LKZX9hG"}],"key":"wXltegla4u"}],"key":"t7mltMA5C1"},{"type":"tableRow","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"inlineCode","value":"remove_entry_exit_signals","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"Z3Mrf3cBw6"}],"key":"zrVQNWwsWx"},{"type":"tableCell","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"在接收数据框时从数据框中删除信号列（将它们设置为 0）。","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"Bn3DhkjonD"},{"type":"break","key":"QV2pQPcIeO"},{"type":"emphasis","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"默认为 ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"kn1kjSZIEe"},{"type":"inlineCode","value":"false","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"Rf01OQJ649"},{"type":"text","value":"。","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"p1yxuqOSjD"}],"key":"FiTbpU2k0W"},{"type":"break","key":"cH5dYsauKh"},{"type":"text","value":" ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"xSTy7VKSri"},{"type":"strong","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"F6Ofq4oUS6"}],"key":"AeWKQ0recJ"},{"type":"text","value":" 布尔值。","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"Fje88ICoQa"}],"key":"TAVTbQNp31"}],"key":"oNxXIGrx4L"},{"type":"tableRow","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"inlineCode","value":"initial_candle_limit","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"dj42IaKsVG"}],"key":"lgj9Vqvi4R"},{"type":"tableCell","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"从生产者预期的初始蜡烛图数量。","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"IRImlJOMR3"},{"type":"break","key":"oetet2ElmP"},{"type":"emphasis","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"默认为 ","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"UrelsQ9wMv"},{"type":"inlineCode","value":"1500","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"pE6m34zpTe"},{"type":"text","value":"。","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"b2wI7bbyVi"}],"key":"yK2EBHcL69"},{"type":"break","key":"SyzwGFODEU"},{"type":"text","value":" ","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"c7NAJyFLcS"},{"type":"strong","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"QhjdcDMHQe"}],"key":"dX8Rn9kypI"},{"type":"text","value":" 整数 - 蜡烛图数量。","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"A1Dy6ikZ5P"}],"key":"U1qzMV5din"}],"key":"xclsYyjLro"},{"type":"tableRow","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"inlineCode","value":"message_size_limit","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"xs7I0Ijhwc"}],"key":"ElzmLfDPwo"},{"type":"tableCell","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"每条消息的大小限制","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"viMWOvv8D6"},{"type":"break","key":"qcP7J7KtMc"},{"type":"emphasis","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"默认为 ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"qFtRrZVVOR"},{"type":"inlineCode","value":"8","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"LoWR5oW0UB"},{"type":"text","value":"。","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"saGXkz6U5O"}],"key":"uw280ztESs"},{"type":"break","key":"qMvpS1fcGT"},{"type":"text","value":" ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"lbYEvaF2b2"},{"type":"strong","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"数据类型：","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"NheL1vywdi"}],"key":"VQbmPaoTLR"},{"type":"text","value":" 整数 - 兆字节。","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"iZ2yprxnFV"}],"key":"lZTryrzeHI"}],"key":"JXOqDV5V0w"}],"key":"htNeTsMzvq"},{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"消费者实例不是（或除了）在 ","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"kfkNY0kuHK"},{"type":"inlineCode","value":"populate_indicators()","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"VkRGiwC1sP"},{"type":"text","value":" 中计算指标，而是监听与生产者实例消息的连接（或在高级配置中监听多个生产者实例），并请求生产者最近为活跃白名单中的每个交易对分析的数据框。","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"hn1Wjg94dF"}],"key":"vHANclPgwq"},{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"然后，消费者实例将拥有分析数据框的完整副本，而无需自己计算它们。","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"a1Qp8yLMQA"}],"key":"P0aQnW9Qtm"},{"type":"heading","depth":2,"position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"示例","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"d0a0SIPDBv"}],"identifier":"id","label":"示例","html_id":"id-1","implicit":true,"key":"O1lCTq4ayK"},{"type":"heading","depth":3,"position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"示例 - 生产者策略","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"QxVNbV5bhY"}],"identifier":"id","label":"示例 - 生产者策略","html_id":"id-2","implicit":true,"key":"kJen6WfySE"},{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"一个具有多个指标的简单策略。策略本身不需要特殊考虑。","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"aZNj571l1S"}],"key":"yqqqBc6DWG"},{"type":"code","lang":"python","value":"class ProducerStrategy(IStrategy):\n    #...\n    def populate_indicators(self, dataframe: DataFrame, metadata: dict) -> DataFrame:\n        \"\"\"\n        以标准的 freqtrade 方式计算指标，然后可以广播到其他实例\n        \"\"\"\n        dataframe['rsi'] = ta.RSI(dataframe)\n        bollinger = qtpylib.bollinger_bands(qtpylib.typical_price(dataframe), window=20, stds=2)\n        dataframe['bb_lowerband'] = bollinger['lower']\n        dataframe['bb_middleband'] = bollinger['mid']\n        dataframe['bb_upperband'] = bollinger['upper']\n        dataframe['tema'] = ta.TEMA(dataframe, timeperiod=9)\n\n        return dataframe\n\n    def populate_entry_trend(self, dataframe: DataFrame, metadata: dict) -> DataFrame:\n        \"\"\"\n        为给定的数据框填充入场信号\n        \"\"\"\n        dataframe.loc[\n            (\n                (qtpylib.crossed_above(dataframe['rsi'], self.buy_rsi.value)) &\n                (dataframe['tema'] <= dataframe['bb_middleband']) &\n                (dataframe['tema'] > dataframe['tema'].shift(1)) &\n                (dataframe['volume'] > 0)\n            ),\n            'enter_long'] = 1\n\n        return dataframe","position":{"start":{"line":84,"column":1},"end":{"line":114,"column":1}},"key":"anX84A1qWa"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"FreqAI","position":{"start":{"line":116,"column":1},"end":{"line":116,"column":1}},"key":"mxZQVQIXsZ"}],"key":"OgZvCewEcf"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"你可以使用这个在功能强大的机器上设置 ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"N0wmwtqoAS"},{"type":"link","url":"/freqai","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"FreqAI","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"eeIKJqLGlN"}],"urlSource":"freqai.md","dataUrl":"/freqai.json","internal":true,"protocol":"file","key":"nKa6rmzByn"},{"type":"text","value":"，同时在树莓派等简单机器上运行消费者，这些消费者可以以不同的方式解释生产者生成的信号。","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"FCLclZ7Cvp"}],"key":"PZzINlhLty"}],"key":"E4DMnVZLkz"},{"type":"heading","depth":3,"position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"示例 - 消费者策略","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"rMT5DWJoeT"}],"identifier":"id","label":"示例 - 消费者策略","html_id":"id-3","implicit":true,"key":"w2EDJ9F2Sa"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"一个逻辑上等效的策略，它自己不计算任何指标，但将具有相同的分析数据框可用于基于生产者在生产者中计算的指标做出交易决策。在此示例中，消费者具有相同的入场标准，但这不是必需的。消费者可以使用不同的逻辑来入场/出场交易，并且只使用指定的指标。","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"r4XBCiK4q2"}],"key":"PVQa3o3D09"},{"type":"code","lang":"python","value":"class ConsumerStrategy(IStrategy):\n    #...\n    process_only_new_candles = False # 消费者必需\n\n    _columns_to_expect = ['rsi_default', 'tema_default', 'bb_middleband_default']\n\n    def populate_indicators(self, dataframe: DataFrame, metadata: dict) -> DataFrame:\n        \"\"\"\n        使用 websocket api 从另一个 freqtrade 实例获取预填充的指标。\n        使用 `self.dp.get_producer_df(pair)` 获取数据框\n        \"\"\"\n        pair = metadata['pair']\n        timeframe = self.timeframe\n\n        producer_pairs = self.dp.get_producer_pairs()\n        # 你可以通过以下方式指定从哪个生产者获取交易对：\n        # self.dp.get_producer_pairs(\"my_other_producer\")\n\n        # 此函数返回分析的数据框，以及它被分析的时间\n        producer_dataframe, _ = self.dp.get_producer_df(pair)\n        # 如果生产者提供，你可以获取其他数据：\n        # self.dp.get_producer_df(\n        #   pair,\n        #   timeframe=\"1h\",\n        #   candle_type=CandleType.SPOT,\n        #   producer_name=\"my_other_producer\"\n        # )\n\n        if not producer_dataframe.empty:\n            # 如果你计划直接传递生产者的入场/出场信号，\n            # 指定 ffill=False，否则会有意外的结果\n            merged_dataframe = merge_informative_pair(dataframe, producer_dataframe,\n                                                      timeframe, timeframe,\n                                                      append_timeframe=False,\n                                                      suffix=\"default\")\n            return merged_dataframe\n        else:\n            dataframe[self._columns_to_expect] = 0\n\n        return dataframe\n\n    def populate_entry_trend(self, dataframe: DataFrame, metadata: dict) -> DataFrame:\n        \"\"\"\n        为给定的数据框填充入场信号\n        \"\"\"\n        # 使用数据框列，就像我们自己计算它们一样\n        dataframe.loc[\n            (\n                (qtpylib.crossed_above(dataframe['rsi_default'], self.buy_rsi.value)) &\n                (dataframe['tema_default'] <= dataframe['bb_middleband_default']) &\n                (dataframe['tema_default'] > dataframe['tema_default'].shift(1)) &\n                (dataframe['volume'] > 0)\n            ),\n            'enter_long'] = 1\n\n        return dataframe","position":{"start":{"line":124,"column":1},"end":{"line":181,"column":1}},"key":"K8vWZI5oEP"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"使用上游信号","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"qMgQPJSuqx"}],"key":"ijVInUtKdh"},{"type":"paragraph","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"text","value":"通过设置 ","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"BGW0pEi4Pq"},{"type":"inlineCode","value":"remove_entry_exit_signals=false","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"MSNT2wlaUz"},{"type":"text","value":"，你也可以直接使用生产者的信号。它们应该可以作为 ","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"oASn7Q8Ybh"},{"type":"inlineCode","value":"enter_long_default","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"Wl3pGyABL4"},{"type":"text","value":" 使用（假设使用了 ","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"dvEliVQz08"},{"type":"inlineCode","value":"suffix=\"default\"","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"zjLlMrF7Y6"},{"type":"text","value":"）- 并且可以直接用作信号，或作为附加指标。","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"HXozMUI8Zq"}],"key":"dwVi12XhR2"}],"key":"hQKD7ncRzk"}],"key":"QLOETQvWEG"}],"key":"pquaaocH0A"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"高级委托流分析","short_title":"委托流分析","url":"/advanced-orderflow","group":"高级话题"},"next":{"title":"SQL 助手","short_title":"SQL 助手","url":"/sql-cheatsheet","group":"高级话题"}}},"domain":"http://localhost:3001"}