{"version":2,"kind":"Article","sha256":"de82e6c0720db95ec51bd3b4c0c6dda363c0e5dbfcea93127ec060037e648d80","slug":"advanced-setup","location":"/advanced-setup.md","dependencies":[],"frontmatter":{"title":"高级安装后配置","description":"本文档介绍了 FreqTrade 安装后可以执行的高级任务和配置选项,包括多实例运行、日志配置等高级特性。","short_title":"高级安装","subtitle":"安装后的高级配置选项","subject":"FreqTrade 高级安装指南","authors":[{"id":"Freqtrade","name":"Freqtrade"}],"github":"https://github.com/freqtrade-cn/docs_zh-CN","keywords":["Freqtrade","中文文档","交易机器人","量化交易","加密货币","数字货币","区块链","人工智能","机器学习"],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/freqtrade-cn/docs_zh-CN/blob/main/advanced-setup.md","exports":[{"format":"md","filename":"advanced-setup.md","url":"/build/advanced-setup-a2651fdc033a3c836404a0a7bdfd9ffb.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"高级安装后任务","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"QcC9KMYrNZ"}],"identifier":"id","label":"高级安装后任务","html_id":"id","implicit":true,"key":"z4G6m3DF6C"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"本页介绍了一些在机器人安装后可以执行的高级任务和配置选项，在某些环境下可能会用到。","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"sUea6UqT5n"}],"key":"ktkJf4gYld"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"如果你不了解这里提到的内容，通常你并不需要这些操作。","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"po6vqCgYKH"}],"key":"UO3MOhY2AX"},{"type":"heading","depth":3,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"运行多个 Freqtrade 实例","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"L0wZ0LJ5Qp"}],"identifier":"id-freqtrade","label":"运行多个 Freqtrade 实例","html_id":"id-freqtrade","implicit":true,"key":"fBICev4Hz0"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"本节将介绍如何在同一台机器上同时运行多个机器人。","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"vQRNDAUH6N"}],"key":"DHpMtKBEkd"},{"type":"heading","depth":4,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"需要注意的事项","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"zH820ITuRo"}],"identifier":"id","label":"需要注意的事项","html_id":"id-1","implicit":true,"key":"mlpO30e4lx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"使用不同的数据库文件。","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"lADJD4fHdT"}],"key":"Y6gmhTpAUR"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"使用不同的 Telegram 机器人（需要多个不同的配置文件，仅在启用 Telegram 时适用）。","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"sp0cNcRwwZ"}],"key":"LI6f7QR0sA"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"使用不同的端口（仅在启用 Freqtrade REST API Web 服务器时适用）。","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"See0jAMsnf"}],"key":"RgLQ5YRQzs"}],"key":"MCE5SdAPZM"},{"type":"heading","depth":4,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"不同的数据库文件","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"qFNcQnnBzn"}],"identifier":"id","label":"不同的数据库文件","html_id":"id-2","implicit":true,"key":"nDNTdqgj2D"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"为了跟踪你的交易、利润等，freqtrade 使用 SQLite 数据库存储各种信息，如你过去执行的交易和当前持有的仓位。这不仅可以让你跟踪利润，更重要的是，即使机器人进程重启或意外终止，也能保持活动状态的追踪。","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"sonljrENBw"}],"key":"kpHwKytktX"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"默认情况下，freqtrade 会为 dry-run 和实盘机器人分别使用不同的数据库文件（假设配置和命令行参数中都未指定 database-url）。实盘模式下默认数据库为 ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"bylvwQWBLi"},{"type":"inlineCode","value":"tradesv3.sqlite","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"UBF570fyAo"},{"type":"text","value":"，dry-run 模式下为 ","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"rUruApllOu"},{"type":"inlineCode","value":"tradesv3.dryrun.sqlite","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"WElU30hygY"},{"type":"text","value":"。","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"Wm7Z0GjhmO"}],"key":"eM3LmYfPI8"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"用于指定这些文件路径的可选参数是 ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"XZHpOrhxOR"},{"type":"inlineCode","value":"--db-url","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ppQwbkzdXp"},{"type":"text","value":"，它需要一个有效的 SQLAlchemy url。\n因此，当你仅用 config 和 strategy 参数以 dry-run 模式启动机器人时，以下两条命令效果相同：","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"JfDyFp5o3m"}],"key":"wIdZ6yFeVp"},{"type":"code","lang":"bash","value":"freqtrade trade -c MyConfig.json -s MyStrategy\n# 等价于\nfreqtrade trade -c MyConfig.json -s MyStrategy --db-url sqlite:///tradesv3.dryrun.sqlite","position":{"start":{"line":34,"column":1},"end":{"line":38,"column":1}},"key":"ikI7vJp5yI"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"这意味着，如果你在两个不同的终端运行 trade 命令（例如分别测试 USDT 和 BTC 交易），你需要为它们指定不同的数据库。","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"pjP3BlaF0z"}],"key":"RPqHDmTnU4"},{"type":"paragraph","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"text","value":"如果你指定的数据库文件不存在，freqtrade 会自动创建一个同名数据库。因此，你可以用如下命令（在两个终端分别执行）测试自定义策略的 BTC 和 USDT 本位：","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"Gv2LfNExbJ"}],"key":"NWdCm5S181"},{"type":"code","lang":"bash","value":"# 终端 1：\nfreqtrade trade -c MyConfigBTC.json -s MyCustomStrategy --db-url sqlite:///user_data/tradesBTC.dryrun.sqlite\n# 终端 2：\nfreqtrade trade -c MyConfigUSDT.json -s MyCustomStrategy --db-url sqlite:///user_data/tradesUSDT.dryrun.sqlite","position":{"start":{"line":44,"column":1},"end":{"line":49,"column":1}},"key":"gTazpcevzI"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"同理，如果你想在实盘模式下做同样的事，也需要为每个实例创建至少一个新数据库，并指定“实盘”数据库路径，例如：","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"cUv3PB3DS6"}],"key":"EMr3F2sMYy"},{"type":"code","lang":"bash","value":"# 终端 1：\nfreqtrade trade -c MyConfigBTC.json -s MyCustomStrategy --db-url sqlite:///user_data/tradesBTC.live.sqlite\n# 终端 2：\nfreqtrade trade -c MyConfigUSDT.json -s MyCustomStrategy --db-url sqlite:///user_data/tradesUSDT.live.sqlite","position":{"start":{"line":53,"column":1},"end":{"line":58,"column":1}},"key":"iuEio5Z6we"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"关于 sqlite 数据库的更多用法（如手动录入或删除交易），请参见 ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"LYdsI52Imf"},{"type":"link","url":"/sql-cheatsheet","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"SQL 速查表","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"BVflkf9dA1"}],"urlSource":"sql_cheatsheet.md","dataUrl":"/sql-cheatsheet.json","internal":true,"protocol":"file","key":"fHa0KhmgED"},{"type":"text","value":"。","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"oB6gxthtZ2"}],"key":"iRMFoollTF"},{"type":"heading","depth":4,"position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"text","value":"使用 docker 运行多个实例","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"hV21JZyLNz"}],"identifier":"id-docker","label":"使用 docker 运行多个实例","html_id":"id-docker","implicit":true,"key":"zIfUUU88Fh"},{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"要用 docker 运行多个 freqtrade 实例，你需要编辑 docker-compose.yml 文件，将所有实例作为独立服务添加。你可以将配置拆分为多个文件，便于模块化管理，这样如果需要修改所有机器人的通用配置，只需改一个文件即可。","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"NuqEhq4reR"}],"key":"qvJhDXp8zF"},{"type":"code","lang":"yml","value":"---\nversion: '3'\nservices:\n  freqtrade1:\n    image: freqtradeorg/freqtrade:stable\n    # image: freqtradeorg/freqtrade:develop\n    # 使用带绘图功能的镜像\n    # image: freqtradeorg/freqtrade:develop_plot\n    # 仅在需要额外依赖时才需 build\n    # build:\n    #   context: .\n    #   dockerfile: \"./docker/Dockerfile.custom\"\n    restart: always\n    container_name: freqtrade1\n    volumes:\n      - \"./user_data:/freqtrade/user_data\"\n    # 在本地 8080 端口暴露 api\n    # 启用前请阅读 https://www.freqtrade.io/zh_CN/latest/rest-api/ 文档\n     ports:\n     - \"127.0.0.1:8080:8080\"\n    # 运行 `docker compose up` 时的默认命令\n    command: >\n      trade\n      --logfile /freqtrade/user_data/logs/freqtrade1.log\n      --db-url sqlite:////freqtrade/user_data/tradesv3_freqtrade1.sqlite\n      --config /freqtrade/user_data/config.json\n      --config /freqtrade/user_data/config.freqtrade1.json\n      --strategy SampleStrategy\n  \n  freqtrade2:\n    image: freqtradeorg/freqtrade:stable\n    # image: freqtradeorg/freqtrade:develop\n    # 使用带绘图功能的镜像\n    # image: freqtradeorg/freqtrade:develop_plot\n    # 仅在需要额外依赖时才需 build\n    # build:\n    #   context: .\n    #   dockerfile: \"./docker/Dockerfile.custom\"\n    restart: always\n    container_name: freqtrade2\n    volumes:\n      - \"./user_data:/freqtrade/user_data\"\n    # 在本地 8081 端口暴露 api\n    # 启用前请阅读 https://www.freqtrade.io/zh_CN/latest/rest-api/ 文档\n    ports:\n      - \"127.0.0.1:8081:8080\"\n    # 运行 `docker compose up` 时的默认命令\n    command: >\n      trade\n      --logfile /freqtrade/user_data/logs/freqtrade2.log\n      --db-url sqlite:////freqtrade/user_data/tradesv3_freqtrade2.sqlite\n      --config /freqtrade/user_data/config.json\n      --config /freqtrade/user_data/config.freqtrade2.json\n      --strategy SampleStrategy\n","position":{"start":{"line":66,"column":1},"end":{"line":122,"column":1}},"key":"ha4lCiuskO"},{"type":"paragraph","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"你可以使用任意命名方式，freqtrade1 和 freqtrade2 只是示例。注意，每个实例都需要不同的数据库文件、端口映射和 telegram 配置。","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"U0u07Lbzc3"}],"key":"r72lR3FSUq"},{"type":"heading","depth":3,"position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"使用不同的数据库系统","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"NJa5dik9AX"}],"identifier":"id","label":"使用不同的数据库系统","html_id":"id-3","implicit":true,"key":"OB8IOXBZez"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":129,"column":1}},"children":[{"type":"text","value":"Freqtrade 使用 SQLAlchemy，支持多种数据库系统。因此，理论上支持多种数据库。\nFreqtrade 不会自动安装任何额外的数据库驱动。请参考 ","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"jS1qoODyry"},{"type":"link","url":"https://docs.sqlalchemy.org/en/14/core/engines.html#database-urls","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"SQLAlchemy 文档","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"xr4vXW3Vet"}],"urlSource":"https://docs.sqlalchemy.org/en/14/core/engines.html#database-urls","key":"Y37aNDAOem"},{"type":"text","value":" 获取各数据库系统的安装说明。","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"heQr1fXuE9"}],"key":"QaoXpdHcty"},{"type":"paragraph","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"children":[{"type":"text","value":"已知可用的数据库系统有：","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"nYbXdaIBzw"}],"key":"dtYYJq31ob"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":133,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"sqlite（默认）","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"FECCnzjv2t"}],"key":"MgBjSr6qz1"},{"type":"listItem","spread":true,"position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"text","value":"PostgreSQL","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"hNNPFrjQ7q"}],"key":"QkgmRyEw4A"},{"type":"listItem","spread":true,"position":{"start":{"line":135,"column":1},"end":{"line":136,"column":1}},"children":[{"type":"text","value":"MariaDB","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"HQWjvbNTYN"}],"key":"ZAWwbGtJzW"}],"key":"SQ5QOPPFx3"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"zrrHuKZPKi"}],"key":"WKKjGTi5cP"},{"type":"paragraph","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"使用下列数据库系统时，需自行负责管理。Freqtrade 团队不提供安装、维护（或备份）等支持。","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"UmgJ7LjbvC"}],"key":"K81yqZuQqJ"}],"key":"lQi8M8dhF1"},{"type":"heading","depth":4,"position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"text","value":"PostgreSQL","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"eWNlUovRba"}],"identifier":"postgresql","label":"PostgreSQL","html_id":"postgresql","implicit":true,"key":"W3V0o3ZnCh"},{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"text","value":"安装：\n","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"vQY8gLZ3Wj"},{"type":"inlineCode","value":"pip install psycopg2-binary","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"J40O36Li8a"}],"key":"rzrQsu1iHq"},{"type":"paragraph","position":{"start":{"line":146,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"用法：\n","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"HpNBYExZWf"},{"type":"inlineCode","value":"... --db-url postgresql+psycopg2://<用户名>:<密码>@localhost:5432/<数据库>","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"qrhZo1K1UB"}],"key":"RaqKi5xee7"},{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"Freqtrade 启动时会自动创建所需表。","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"LC7EqoV5HT"}],"key":"O5KFphGNYE"},{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"如运行多个 Freqtrade 实例，需为每个实例单独建库，或为每个连接使用不同用户/Schema。","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"FcHwNLFQO0"}],"key":"QdSIxeMDiE"},{"type":"heading","depth":4,"position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"text","value":"MariaDB / MySQL","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"VDqdrV4qHZ"}],"identifier":"mariadb-mysql","label":"MariaDB / MySQL","html_id":"mariadb-mysql","implicit":true,"key":"VjL70uEFhf"},{"type":"paragraph","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"text","value":"Freqtrade 通过 SQLAlchemy 支持 MariaDB。","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"Emat2haWtU"}],"key":"hS9MIKXMq5"},{"type":"paragraph","position":{"start":{"line":157,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"安装：\n","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"YSfHXOAQOc"},{"type":"inlineCode","value":"pip install pymysql","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"encw5bwoYr"}],"key":"v1HwfjeTkZ"},{"type":"paragraph","position":{"start":{"line":160,"column":1},"end":{"line":161,"column":1}},"children":[{"type":"text","value":"用法：\n","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"SsCHnGxPsA"},{"type":"inlineCode","value":"... --db-url mysql+pymysql://<用户名>:<密码>@localhost:3306/<数据库>","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"imcboKcgjO"}],"key":"vWGSLPUQ7g"},{"type":"heading","depth":3,"position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"children":[{"type":"text","value":"配置机器人为 systemd 服务","position":{"start":{"line":165,"column":1},"end":{"line":165,"column":1}},"key":"Evcfo6s3hO"}],"label":"configure-the-bot-running-as-a-systemd-service","identifier":"configure-the-bot-running-as-a-systemd-service","html_id":"configure-the-bot-running-as-a-systemd-service","key":"WGftxqjGst"},{"type":"paragraph","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"children":[{"type":"text","value":"将 ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"x2uxeW0lae"},{"type":"inlineCode","value":"freqtrade.service","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"DWUr6OXL7K"},{"type":"text","value":" 文件复制到你的 systemd 用户目录（通常为 ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"ypN4MlZrWT"},{"type":"inlineCode","value":"~/.config/systemd/user","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"KtkatcYvpb"},{"type":"text","value":"），并根据实际情况修改 ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"ywZt0AA4gR"},{"type":"inlineCode","value":"WorkingDirectory","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"YrUEH6eEC5"},{"type":"text","value":" 和 ","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"M8EGbf9yQf"},{"type":"inlineCode","value":"ExecStart","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"GHNflNAP4F"},{"type":"text","value":"。","position":{"start":{"line":167,"column":1},"end":{"line":167,"column":1}},"key":"ZkSStA7b6T"}],"key":"B8wc7iweCz"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"aAtiOjSMcq"}],"key":"CShJH11PxJ"},{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"某些系统（如 Raspbian）不会从用户目录加载服务单元文件。这种情况下，请将 ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"hBuXod1CyL"},{"type":"inlineCode","value":"freqtrade.service","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"wa6DAw420Z"},{"type":"text","value":" 复制到 ","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"N0d042iquI"},{"type":"inlineCode","value":"/etc/systemd/user/","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"X86gRUqKxw"},{"type":"text","value":"（需超级用户权限）。","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"SrGjAkRNH0"}],"key":"G8Gtb3hpUq"}],"key":"CYSpD8NuPu"},{"type":"paragraph","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"之后可用如下命令启动守护进程：","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"Id6vwcoEoO"}],"key":"FwhYpfBxfx"},{"type":"code","lang":"bash","value":"systemctl --user start freqtrade","position":{"start":{"line":175,"column":1},"end":{"line":177,"column":1}},"key":"IfXZ6RO1YN"},{"type":"paragraph","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"children":[{"type":"text","value":"如需在用户注销后仍能运行，需为 freqtrade 用户启用 linger：","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"KJtrdcua09"}],"key":"GHLqZEBqkM"},{"type":"code","lang":"bash","value":"sudo loginctl enable-linger \"$USER\"","position":{"start":{"line":181,"column":1},"end":{"line":183,"column":1}},"key":"A4AXICPjNO"},{"type":"paragraph","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"如以服务方式运行机器人，可用 systemd 服务管理器作为软件 watchdog 监控 freqtrade 状态，并在故障时自动重启。如果配置文件中设置了 ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"QGbI7q6nUu"},{"type":"inlineCode","value":"internals.sd_notify","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"kghlyS2Sb4"},{"type":"text","value":" 为 true，或命令行使用了 ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"y1ohyU7lNk"},{"type":"inlineCode","value":"--sd-notify","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"VA47gM2OD9"},{"type":"text","value":"，机器人会通过 sd_notify 协议向 systemd 发送心跳，并在状态变化时告知 systemd 当前状态（运行、暂停或停止）。","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"lKlNK1C9fJ"}],"key":"i5goJpeyTZ"},{"type":"paragraph","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"inlineCode","value":"freqtrade.service.watchdog","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"Oiaorf4Hwg"},{"type":"text","value":" 文件提供了使用 systemd 作为 watchdog 的服务单元配置示例。","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"tgQOs2RZzr"}],"key":"Rm9y6vCDLV"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"L6PGk1PFs6"}],"key":"pOoiLkM9iR"},{"type":"paragraph","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"text","value":"如果机器人运行在 Docker 容器中，sd_notify 与 systemd 服务管理器之间的通信将无法工作。","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"NFIyKZJj3N"}],"key":"lognuiJk8l"}],"key":"syCx8vBBA6"},{"type":"heading","depth":3,"position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"高级日志配置","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"zLqneauNoy"}],"label":"advanced-logging","identifier":"advanced-logging","html_id":"advanced-logging","key":"QNJwDk8yah"},{"type":"paragraph","position":{"start":{"line":197,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"Freqtrade 使用 Python 的默认 logging 模块。\nPython 支持非常丰富的","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"SK2sJxnK7s"},{"type":"link","url":"https://docs.python.org/3/library/logging.config.html#logging.config.dictConfig","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"text","value":"日志配置","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"UwQc1AoJu5"}],"urlSource":"https://docs.python.org/3/library/logging.config.html#logging.config.dictConfig","key":"ZH34Ny655P"},{"type":"text","value":"，远超本页所能涵盖。","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"ABTygKc4OF"}],"key":"fv8Z1lwFGn"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"如果 freqtrade 配置文件未提供 ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"UOw9MY6OXo"},{"type":"inlineCode","value":"log_config","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"U0kCq16ycu"},{"type":"text","value":"，则默认使用彩色终端输出格式。使用 ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"JNHSHgonRu"},{"type":"inlineCode","value":"--logfile logfile.log","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"gEeO9UpqEt"},{"type":"text","value":" 会启用 RotatingFileHandler。","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"JLFEHOvY32"}],"key":"HLN1vOndtw"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"如不满意日志格式或 RotatingFileHandler 的默认设置，可通过在配置文件中添加 ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"h4ZBvXCIim"},{"type":"inlineCode","value":"log_config","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"lZXmNCy5sw"},{"type":"text","value":" 自定义日志。","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"Kqaw6X0iPo"}],"key":"sO9VOyiULl"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"默认配置大致如下，文件处理器已提供但未启用（","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"qmPHrpb7KU"},{"type":"inlineCode","value":"filename","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"djIgsAHMJM"},{"type":"text","value":" 行被注释）。取消注释并填写有效路径即可启用。","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"RguJPd8ikj"}],"key":"X3ogAEkd4C"},{"type":"code","lang":"json","value":"{\n  \"log_config\": {\n      \"version\": 1,\n      \"formatters\": {\n          \"basic\": {\n              \"format\": \"%(message)s\"\n          },\n          \"standard\": {\n              \"format\": \"%(asctime)s - %(name)s - %(levelname)s - %(message)s\"\n          }\n      },\n      \"handlers\": {\n          \"console\": {\n              \"class\": \"freqtrade.loggers.ft_rich_handler.FtRichHandler\",\n              \"formatter\": \"basic\"\n          },\n          \"file\": {\n              \"class\": \"logging.handlers.RotatingFileHandler\",\n              \"formatter\": \"standard\",\n              // \"filename\": \"someRandomLogFile.log\",\n              \"maxBytes\": 10485760,\n              \"backupCount\": 10\n          }\n      },\n      \"root\": {\n          \"handlers\": [\n              \"console\",\n              // \"file\"\n          ],\n          \"level\": \"INFO\",\n      }\n  }\n}","position":{"start":{"line":206,"column":1},"end":{"line":240,"column":1}},"key":"Hy8YK0OjX8"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"高亮行","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"X5MwXWTx6P"}],"key":"EXLaCfbQL6"},{"type":"paragraph","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"children":[{"type":"text","value":"上述代码块中高亮的行定义了 Rich handler，属于同一组。","position":{"start":{"line":243,"column":1},"end":{"line":243,"column":1}},"key":"KOqI1zNuQs"}],"key":"Tkjd9x13uM"},{"type":"paragraph","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"children":[{"type":"text","value":"格式化器 “standard” 和 “file” 属于 FileHandler。","position":{"start":{"line":245,"column":1},"end":{"line":245,"column":1}},"key":"kRH4z0HJ9a"}],"key":"cbxjRNZSsh"}],"key":"Ton7XMA9w1"},{"type":"paragraph","position":{"start":{"line":248,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"text","value":"每个 handler 必须使用已定义的 formatter（按名称），其 class 必须可用且为有效日志类。\n要实际启用 handler，需在 “root” 段的 “handlers” 列表中添加。\n如省略该段，freqtrade 不会输出日志（至少不会用未配置的 handler 输出）。","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"iZQOrsvs2S"}],"key":"D8mJPRa6eF"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"显式日志配置","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"hEIvrDy2Gv"}],"key":"x8VbiUNoWt"},{"type":"paragraph","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"建议将日志配置从主配置文件中提取出来，通过","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"nw1xWr3C9W"},{"type":"crossReference","url":"/configuration","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"多配置文件","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"PCm5oEM7fi"}],"urlSource":"configuration.md#multiple-configuration-files","dataUrl":"/configuration.json","identifier":"multiple-configuration-files","label":"multiple-configuration-files","remote":true,"protocol":"file","kind":"heading","template":"{name}","resolved":true,"html_id":"multiple-configuration-files","key":"Oz6ssPi0A1"},{"type":"text","value":"功能传递给机器人，避免重复代码。","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"wz2GLQt4yZ"}],"key":"G45e6QqQUl"}],"key":"E8ZGAcVn8r"},{"type":"thematicBreak","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"EjlYoMKyt4"},{"type":"paragraph","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"在许多 Linux 系统上，机器人可配置为将日志发送到 ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"PW1HiZjt7Y"},{"type":"inlineCode","value":"syslog","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"RK7kaQmp1n"},{"type":"text","value":" 或 ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"N19EEea7oi"},{"type":"inlineCode","value":"journald","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"qzpGsyvdUa"},{"type":"text","value":" 系统服务。Windows 下也可远程记录到 syslog 服务器。","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"zDPvcs9Bq6"},{"type":"inlineCode","value":"--logfile","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"CuADuidzX3"},{"type":"text","value":" 命令行参数可用于此目的。","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"CgOLw6yyTw"}],"key":"BRXSuGYzdF"},{"type":"heading","depth":4,"position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"children":[{"type":"text","value":"日志输出到 syslog","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"G3nylUuQjn"}],"identifier":"id-syslog","label":"日志输出到 syslog","html_id":"id-syslog","implicit":true,"key":"HxsL9gcU3X"},{"type":"paragraph","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"text","value":"要将 Freqtrade 日志发送到本地或远程 ","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"BgIx92qPdo"},{"type":"inlineCode","value":"syslog","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"U2mlwSnhQp"},{"type":"text","value":"，请用 “log_config” 配置日志。","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"StIsW0Ha9j"}],"key":"MCw9GgDMvz"},{"type":"code","lang":"json","value":"{\n  // ...\n  \"log_config\": {\n    \"version\": 1,\n    \"formatters\": {\n      \"syslog_fmt\": {\n        \"format\": \"%(name)s - %(levelname)s - %(message)s\"\n      }\n    },\n    \"handlers\": {\n      // 其他 handler\n      \"syslog\": {\n         \"class\": \"logging.handlers.SysLogHandler\",\n          \"formatter\": \"syslog_fmt\",\n          // 可用上面任一 address\n          \"address\": \"/dev/log\"\n      }\n    },\n    \"root\": {\n      \"handlers\": [\n        // 其他 handler\n        \"syslog\",\n        \n      ]\n    }\n\n  }\n}","position":{"start":{"line":264,"column":1},"end":{"line":293,"column":1}},"key":"nmWzLywR81"},{"type":"paragraph","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"更多日志 handler 配置","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"qrENdcwfMB"}],"identifier":"advanced-logging","label":"advanced-logging","kind":"heading","template":"{name}","resolved":true,"html_id":"advanced-logging","key":"cL3EdIkNSU"},{"type":"text","value":" 可用于同时输出到控制台等。","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"SLMXTK3Zlr"}],"key":"QNHCM8XVJt"},{"type":"heading","depth":5,"position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"Syslog 用法","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"OV3ARzwPPN"}],"identifier":"syslog","label":"Syslog 用法","html_id":"syslog","implicit":true,"key":"ElmCB4jFqY"},{"type":"paragraph","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"children":[{"type":"text","value":"日志以 ","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"BVRxNFGtji"},{"type":"inlineCode","value":"user","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"XQHF3BA8AN"},{"type":"text","value":" facility 发送到 syslog。可用如下命令查看：","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"hkq1I09uwv"}],"key":"RDm1KJQKIO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":301,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"children":[{"type":"inlineCode","value":"tail -f /var/log/user","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"Gua0L97drW"}],"key":"JpeQ2Z51tr"},{"type":"listItem","spread":true,"position":{"start":{"line":302,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"text","value":"或安装图形日志查看器（如 Ubuntu 的 ‘Log File Viewer’）。","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"YJCfETqRj7"}],"key":"jRbkzPXeg6"}],"key":"Jb2a5creOC"},{"type":"paragraph","position":{"start":{"line":304,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"许多系统上，syslog（rsyslog）和 journald 互通，因此日志可用 journalctl 或 syslog 工具查看。\n你可根据习惯自由组合。","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"j40GzwusPk"}],"key":"XFJr920a1G"},{"type":"paragraph","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"children":[{"type":"text","value":"如需将机器人日志重定向到专用日志文件，在 ","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"QJ2wPgOrfF"},{"type":"inlineCode","value":"/etc/rsyslog.d/50-default.conf","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"AMQeho0uoL"},{"type":"text","value":" 末尾添加：","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"HeFoZXP5Qr"}],"key":"jqVY7JLVJq"},{"type":"code","lang":"","value":"if $programname startswith \"freqtrade\" then -/var/log/freqtrade.log","position":{"start":{"line":309,"column":1},"end":{"line":311,"column":1}},"key":"Vrciori3yh"},{"type":"paragraph","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"children":[{"type":"text","value":"如需开启 rsyslog 的重复消息抑制（如多条心跳合并为一条），在 ","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"EGxjbM78XU"},{"type":"inlineCode","value":"/etc/rsyslog.conf","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"db5Wae7y9c"},{"type":"text","value":" 添加：","position":{"start":{"line":313,"column":1},"end":{"line":313,"column":1}},"key":"ef80g2txpw"}],"key":"cvX2bvyVBD"},{"type":"code","lang":"","value":"# 过滤重复消息\n$RepeatedMsgReduction on","position":{"start":{"line":315,"column":1},"end":{"line":318,"column":1}},"key":"fMEAv33YAC"},{"type":"heading","depth":5,"position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"children":[{"type":"text","value":"Syslog 地址","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"fIsmWSPHE2"}],"identifier":"syslog","label":"Syslog 地址","html_id":"syslog-1","implicit":true,"key":"wYxnYQdIgU"},{"type":"paragraph","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"children":[{"type":"text","value":"syslog 地址可为 Unix 域套接字（文件名）或 UDP 套接字（IP:端口）。","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"qzw6Seer5A"}],"key":"jAQYA61E87"},{"type":"paragraph","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"常见示例：","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"sQ3TU0Q8V4"}],"key":"rH8rfTUUJ9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":326,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"children":[{"type":"inlineCode","value":"\"address\": \"/dev/log\"","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"fj7FhTHjfU"},{"type":"text","value":" —— 绝大多数系统的本地 syslog。","position":{"start":{"line":326,"column":1},"end":{"line":326,"column":1}},"key":"vh9sdN2EeX"}],"key":"v2dSl2FASj"},{"type":"listItem","spread":true,"position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"children":[{"type":"inlineCode","value":"\"address\": \"/var/run/syslog\"","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"BKehvKN8FF"},{"type":"text","value":" —— MacOS 使用。","position":{"start":{"line":327,"column":1},"end":{"line":327,"column":1}},"key":"giW6yaRGAb"}],"key":"uTgcFKIDde"},{"type":"listItem","spread":true,"position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"children":[{"type":"inlineCode","value":"\"address\": \"localhost:514\"","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"eDuMUlp0wr"},{"type":"text","value":" —— 本地 syslog 的 UDP。","position":{"start":{"line":328,"column":1},"end":{"line":328,"column":1}},"key":"MKjzloL6mz"}],"key":"C3nembOOEY"},{"type":"listItem","spread":true,"position":{"start":{"line":329,"column":1},"end":{"line":330,"column":1}},"children":[{"type":"inlineCode","value":"\"address\": \"<ip>:514\"","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"oKci3RexVY"},{"type":"text","value":" —— 远程 syslog。","position":{"start":{"line":329,"column":1},"end":{"line":329,"column":1}},"key":"mmY7GK5cqq"}],"key":"U2UFlLdbfg"}],"key":"siR3NkJmL2"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"已废弃：命令行配置 syslog","position":{"start":{"line":331,"column":1},"end":{"line":331,"column":1}},"key":"fDO76j7Gwi"}],"key":"atjDJgdVLO"},{"type":"paragraph","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"children":[{"type":"inlineCode","value":"--logfile syslog:<syslog_address>","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"VyP0QU0qqm"},{"type":"text","value":" —— 通过 ","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"fzG8FAZyM4"},{"type":"inlineCode","value":"<syslog_address>","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"FVRVsQqo5l"},{"type":"text","value":" 发送日志到 syslog。","position":{"start":{"line":332,"column":1},"end":{"line":332,"column":1}},"key":"ezCd8XUYY0"}],"key":"QnPqtjfvKx"},{"type":"paragraph","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"children":[{"type":"text","value":"地址可为 Unix 域套接字或 UDP（IP:端口）。","position":{"start":{"line":334,"column":1},"end":{"line":334,"column":1}},"key":"L2h5Gc9Bta"}],"key":"DLqfYtjJLm"},{"type":"paragraph","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"children":[{"type":"text","value":"常见用法：","position":{"start":{"line":336,"column":1},"end":{"line":336,"column":1}},"key":"RStybHS7F7"}],"key":"yiXxhC6ebV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":338,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"children":[{"type":"inlineCode","value":"--logfile syslog:/dev/log","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"faAi3bBUAz"},{"type":"text","value":" —— 本地 syslog。","position":{"start":{"line":338,"column":1},"end":{"line":338,"column":1}},"key":"vkvUfhEfUq"}],"key":"CA3C3sxTh7"},{"type":"listItem","spread":true,"position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"children":[{"type":"inlineCode","value":"--logfile syslog","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"iGO0vhZqVM"},{"type":"text","value":" —— 等同于上。","position":{"start":{"line":339,"column":1},"end":{"line":339,"column":1}},"key":"QOr4TRKl7h"}],"key":"crSRaZkAtX"},{"type":"listItem","spread":true,"position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"children":[{"type":"inlineCode","value":"--logfile syslog:/var/run/syslog","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"n7RX1sezGi"},{"type":"text","value":" —— MacOS。","position":{"start":{"line":340,"column":1},"end":{"line":340,"column":1}},"key":"YJnmViwiEg"}],"key":"GC3942soAv"},{"type":"listItem","spread":true,"position":{"start":{"line":341,"column":1},"end":{"line":341,"column":1}},"children":[{"type":"inlineCode","value":"--logfile syslog:localhost:514","position":{"start":{"line":341,"column":1},"end":{"line":341,"column":1}},"key":"l7z7FXmrSq"},{"type":"text","value":" —— 本地 UDP。","position":{"start":{"line":341,"column":1},"end":{"line":341,"column":1}},"key":"YeZETdntwZ"}],"key":"zda8QZT7fr"},{"type":"listItem","spread":true,"position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"children":[{"type":"inlineCode","value":"--logfile syslog:<ip>:514","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"Lt9QNUoVmo"},{"type":"text","value":" —— 远程 syslog。","position":{"start":{"line":342,"column":1},"end":{"line":342,"column":1}},"key":"xmISRiBe5r"}],"key":"uIh2YYGizZ"}],"key":"w0Ubg8NI6z"}],"key":"dZaTq1K5T9"},{"type":"heading","depth":4,"position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"children":[{"type":"text","value":"日志输出到 journald","position":{"start":{"line":345,"column":1},"end":{"line":345,"column":1}},"key":"bKw1qJWbzr"}],"identifier":"id-journald","label":"日志输出到 journald","html_id":"id-journald","implicit":true,"key":"MKmeDLHnuM"},{"type":"paragraph","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"children":[{"type":"text","value":"需安装 ","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"key":"R8CgcSQDGN"},{"type":"inlineCode","value":"cysystemd","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"key":"IIsN0wfQ1k"},{"type":"text","value":" python 包（","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"key":"WeOfnZ0Woa"},{"type":"inlineCode","value":"pip install cysystemd","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"key":"ElKhzzISTL"},{"type":"text","value":"），Windows 不支持 journald。","position":{"start":{"line":347,"column":1},"end":{"line":347,"column":1}},"key":"vvZXQ5KKDU"}],"key":"n9jPsazUK2"},{"type":"paragraph","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"children":[{"type":"text","value":"要将 Freqtrade 日志发送到 journald，请在配置中添加如下片段：","position":{"start":{"line":349,"column":1},"end":{"line":349,"column":1}},"key":"o7QqPYlgjZ"}],"key":"cqBvUGzwuV"},{"type":"code","lang":"json","value":"{\n  // ...\n  \"log_config\": {\n    \"version\": 1,\n    \"formatters\": {\n      \"journald_fmt\": {\n        \"format\": \"%(name)s - %(levelname)s - %(message)s\"\n      }\n    },\n    \"handlers\": {\n      // 其他 handler\n      \"journald\": {\n         \"class\": \"cysystemd.journal.JournaldLogHandler\",\n          \"formatter\": \"journald_fmt\",\n      }\n    },\n    \"root\": {\n      \"handlers\": [\n        // .. \n        \"journald\",\n        \n      ]\n    }\n\n  }\n}","position":{"start":{"line":351,"column":1},"end":{"line":378,"column":1}},"key":"xUYJLHv6gd"},{"type":"paragraph","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"crossReference","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"children":[{"type":"text","value":"更多日志 handler 配置","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"eD0Qjjdnle"}],"identifier":"advanced-logging","label":"advanced-logging","kind":"heading","template":"{name}","resolved":true,"html_id":"advanced-logging","key":"OSYztq2LBk"},{"type":"text","value":" 可用于同时输出到控制台等。","position":{"start":{"line":380,"column":1},"end":{"line":380,"column":1}},"key":"CLphtquRnl"}],"key":"q6yEoQVArd"},{"type":"paragraph","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"children":[{"type":"text","value":"日志以 ","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"key":"cuG4aUtrAg"},{"type":"inlineCode","value":"user","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"key":"nUv2yKc18D"},{"type":"text","value":" facility 发送到 journald。可用如下命令查看：","position":{"start":{"line":382,"column":1},"end":{"line":382,"column":1}},"key":"DlJaSAGMiX"}],"key":"B0bXrMkFkp"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":384,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"children":[{"type":"inlineCode","value":"journalctl -f","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"oqpt8YdUZh"},{"type":"text","value":" —— 实时查看所有 journald 日志。","position":{"start":{"line":384,"column":1},"end":{"line":384,"column":1}},"key":"JpVpyzcVKj"}],"key":"OdlhEq1Usk"},{"type":"listItem","spread":true,"position":{"start":{"line":385,"column":1},"end":{"line":386,"column":1}},"children":[{"type":"inlineCode","value":"journalctl -f -u freqtrade.service","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"TwnPRnkfWt"},{"type":"text","value":" —— 机器人以 systemd 服务运行时查看。","position":{"start":{"line":385,"column":1},"end":{"line":385,"column":1}},"key":"ukNbmLFz1l"}],"key":"UeGDLm5EkH"}],"key":"t5amdCeh9W"},{"type":"paragraph","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"children":[{"type":"text","value":"journalctl 还有许多过滤选项，详见其手册。","position":{"start":{"line":387,"column":1},"end":{"line":387,"column":1}},"key":"UXoS4rMPfK"}],"key":"wjsjKFIfjS"},{"type":"paragraph","position":{"start":{"line":389,"column":1},"end":{"line":390,"column":1}},"children":[{"type":"text","value":"许多系统上，syslog（rsyslog）和 journald 互通，因此日志可用 ","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"Qf2MJr4Cj0"},{"type":"inlineCode","value":"--logfile syslog","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"aCddoI1YBT"},{"type":"text","value":" 或 ","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"xkEhGb9WWg"},{"type":"inlineCode","value":"--logfile journald","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"GEcl0UYmtu"},{"type":"text","value":"，并可用 journalctl 或 syslog 工具查看。\n你可根据习惯自由组合。","position":{"start":{"line":389,"column":1},"end":{"line":389,"column":1}},"key":"YMtegF6Cw8"}],"key":"oiHHZSOsIX"},{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"已废弃：命令行配置 journald","position":{"start":{"line":392,"column":1},"end":{"line":392,"column":1}},"key":"iv2rubA89X"}],"key":"gU7a09ufq4"},{"type":"paragraph","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"children":[{"type":"text","value":"用 ","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"rMvoIDjtkM"},{"type":"inlineCode","value":"--logfile journald","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"ax3SIvteiY"},{"type":"text","value":" 命令行参数将日志发送到 journald。","position":{"start":{"line":393,"column":1},"end":{"line":393,"column":1}},"key":"RmQ6QBzM35"}],"key":"y5gIH0FXYA"}],"key":"V7Lo3uAnIm"},{"type":"heading","depth":4,"position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"children":[{"type":"text","value":"日志格式为 JSON","position":{"start":{"line":396,"column":1},"end":{"line":396,"column":1}},"key":"hpeVi2ZB9A"}],"identifier":"id-json","label":"日志格式为 JSON","html_id":"id-json","implicit":true,"key":"zeWowXjdhc"},{"type":"paragraph","position":{"start":{"line":398,"column":1},"end":{"line":399,"column":1}},"children":[{"type":"text","value":"你也可以将默认输出流配置为 JSON 格式。\n“fmt_dict” 属性定义了 json 输出的键及 ","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"key":"sd0p4A0OR5"},{"type":"link","url":"https://docs.python.org/3/library/logging.html#logrecord-attributes","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"children":[{"type":"text","value":"python logging LogRecord 属性","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"key":"IPCE7UJrlQ"}],"urlSource":"https://docs.python.org/3/library/logging.html#logrecord-attributes","key":"wRTTOeOcZ5"},{"type":"text","value":"。","position":{"start":{"line":398,"column":1},"end":{"line":398,"column":1}},"key":"KNJ6iqYJHS"}],"key":"qBXwKGimKt"},{"type":"paragraph","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"children":[{"type":"text","value":"如下配置将默认输出改为 JSON。该 formatter 也可与 RotatingFileHandler 配合使用。建议至少保留一种人类可读格式。","position":{"start":{"line":401,"column":1},"end":{"line":401,"column":1}},"key":"F0LyFma7to"}],"key":"wBkSCEbEXm"},{"type":"code","lang":"json","value":"{\n  // ...\n  \"log_config\": {\n    \"version\": 1,\n    \"formatters\": {\n       \"json\": {\n          \"()\": \"freqtrade.loggers.json_formatter.JsonFormatter\",\n          \"fmt_dict\": {\n              \"timestamp\": \"asctime\",\n              \"level\": \"levelname\",\n              \"logger\": \"name\",\n              \"message\": \"message\"\n          }\n      }\n    },\n    \"handlers\": {\n      // 其他 handler\n      \"jsonStream\": {\n          \"class\": \"logging.StreamHandler\",\n          \"formatter\": \"json\"\n      }\n    },\n    \"root\": {\n      \"handlers\": [\n        // .. \n        \"jsonStream\",\n        \n      ]\n    }\n\n  }\n}","position":{"start":{"line":403,"column":1},"end":{"line":436,"column":1}},"key":"gWmxHcBZiX"}],"key":"UpdCMaTGBV"}],"key":"FRhzOTA0LQ"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"高级回测分析","short_title":"高级回测","url":"/advanced-backtesting","group":"数据分析"},"next":{"title":"交易对象文档","short_title":"交易对象指南","url":"/trade-object","group":"高级话题"}}},"domain":"http://localhost:3001"}